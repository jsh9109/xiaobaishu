<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¤¾ä¼šåŒ–ç¨‹åº¦æ·±åº¦è¯„ä¼° - 2025å®æˆ˜ç‰ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ================= è§†è§‰ç³»ç»Ÿï¼šé«˜ç«¯çŸ¥è¯†ä»˜è´¹ + ç´§è¿«æ„Ÿ ================= */
        :root {
            --primary: #8B6E4E;        /* ä¸»è‰²ï¼šæ·±æ£• (æƒå¨æ„Ÿ) */
            --primary-light: #FDF6EC;  /* æµ…è‰²èƒŒæ™¯ */
            --bg-body: #F7F8FA;        /* èƒŒæ™¯ç° */
            --white: #FFFFFF;
            --red-urgency: #FF4D4F;    /* ç´§è¿«çº¢ */
            --text-main: #2C3E50;
            --text-sub: #7F8C8D;
            --gold: #D4AF37;           /* é‡‘è‰²å¼ºè°ƒ */
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg-body);
            color: var(--text-main);
            line-height: 1.5;
            padding: 12px;
            min-height: 100vh;
        }
        .container { max-width: 600px; margin: 0 auto; padding-bottom: 90px; }
        .hidden { display: none !important; }

        /* é€šç”¨å¡ç‰‡ä¼˜åŒ– */
        .card {
            background: var(--white);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03);
            margin-bottom: 15px;
            position: relative;
            overflow: hidden;
        }

        /* æŒ‰é’®ä½“ç³» */
        .btn-primary {
            width: 100%; padding: 14px; border: none; border-radius: 8px;
            background: linear-gradient(135deg, #8B6E4E 0%, #604630 100%);
            color: white; font-size: 16px; font-weight: bold; cursor: pointer;
            box-shadow: 0 4px 10px rgba(139, 110, 78, 0.3); 
            transition: all 0.2s; display: flex; justify-content: center; align-items: center;
        }
        .btn-primary:active { transform: scale(0.98); }
        .btn-pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0% {box-shadow: 0 0 0 0 rgba(139, 110, 78, 0.4);} 70% {box-shadow: 0 0 0 10px rgba(139, 110, 78, 0);} 100% {box-shadow: 0 0 0 0 rgba(139, 110, 78, 0);} }

        /* ================= é¦–é¡µ ================= */
        .header { text-align: center; margin-bottom: 20px; padding: 10px 0; }
        .header h1 { color: var(--primary); font-size: 22px; font-weight: 800; margin-bottom: 5px; }
        .header p { color: var(--text-sub); font-size: 13px; }
        .header .badge { background: #EFEBE9; color: #5D4037; padding: 2px 8px; border-radius: 4px; font-size: 11px; display: inline-block; margin-top: 5px; }

        .stat-bar { 
            background: rgba(0,0,0,0.03); border-radius: 30px; padding: 5px 15px; 
            font-size: 12px; color: #666; display: flex; align-items: center; justify-content: center; margin-bottom: 15px;
        }
        .stat-dot { width: 6px; height: 6px; background: #2E7D32; border-radius: 50%; margin-right: 6px; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0.4; } }

        .dimensions-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0; }
        .dim-card { 
            background: #FAFAFA; border: 1px solid #EEE; border-radius: 8px; padding: 12px; text-align: center;
        }
        .dim-icon { font-size: 24px; display: block; margin-bottom: 4px; }
        .dim-name { font-weight: bold; font-size: 13px; color: #333; }
        .dim-desc { font-size: 11px; color: #999; }

        .feature-box { background: var(--primary-light); border: 1px solid #E2C08D; border-radius: 10px; padding: 15px; margin-bottom: 20px; }
        .feature-list li { 
            list-style: none; font-size: 13px; color: #5D4037; margin-bottom: 8px; 
            padding-left: 20px; position: relative; line-height: 1.4;
        }
        .feature-list li::before { 
            content: "âœ”"; position: absolute; left: 0; color: var(--primary); font-weight: bold;
        }
        .highlight-red { color: var(--red-urgency); font-weight: bold; background: rgba(255, 77, 79, 0.1); padding: 0 4px; border-radius: 2px; }

        .input-group input {
            width: 100%; padding: 14px; border: 1px solid #DDD; border-radius: 8px;
            font-size: 15px; text-align: center; background: #F9F9F9; margin-bottom: 12px;
        }

        /* ================= ç­”é¢˜é¡µ ================= */
        .progress-bar { height: 4px; background: #EEE; border-radius: 2px; margin: 10px 0 20px; }
        .progress-fill { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s; }
        .question-text { font-size: 18px; font-weight: bold; margin-bottom: 25px; line-height: 1.4; color: #222; }
        .option {
            padding: 14px 15px; background: #F9F9F9; border: 1px solid #EEE;
            border-radius: 8px; margin-bottom: 10px; font-size: 14px; font-weight: 500;
        }
        .option.selected { background: var(--primary); color: white; border-color: var(--primary); }
        
        .nav-buttons { display: flex; gap: 10px; margin-top: 25px; }
        .nav-btn { flex: 1; padding: 12px; border-radius: 6px; border: none; font-size: 14px; font-weight: bold; }
        .btn-prev { background: #EEE; color: #999; }
        .btn-next { background: var(--primary); color: white; }

        /* ================= ç»“æœé¡µ ================= */
        .result-header { 
            background: linear-gradient(135deg, #8B6E4E 0%, #5D4037 100%); color: white; 
            text-align: center; padding: 30px 20px; border-radius: 12px 12px 0 0; margin: -20px -20px 20px -20px; 
        }
        .score-val { font-size: 56px; font-weight: 800; line-height: 1; margin: 5px 0; letter-spacing: -2px; }
        .score-label { opacity: 0.8; font-size: 12px; }
        .score-badge { 
            background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 20px; 
            font-size: 12px; font-weight: bold; display: inline-block; margin-top: 5px;
        }

        .chart-box { height: 240px; width: 100%; position: relative; margin-bottom: 20px; }

        /* ç—›ç‚¹å¡ç‰‡ (é«˜è½¬åŒ–å…³é”®) */
        .pain-card { 
            background: #FFF1F0; border: 1px solid #FFCCC7; border-radius: 8px; 
            padding: 15px; margin-bottom: 20px; 
        }
        .pain-title { color: #CF1322; font-weight: bold; font-size: 14px; margin-bottom: 8px; display: flex; align-items: center; }
        .pain-text { font-size: 13px; color: #5c2b2b; line-height: 1.5; }

        /* é”å®šåŒºåŸŸ */
        .locked-wrapper { 
            border: 1px dashed #D9D9D9; border-radius: 8px; background: #FAFAFA; 
            position: relative; overflow: hidden; text-align: center; margin-bottom: 20px;
        }
        .blur-content { filter: blur(4px); opacity: 0.5; padding: 15px; font-size: 13px; color: #999; line-height: 1.8; text-align: left; }
        .lock-overlay { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(255,255,255,0.6); display: flex; flex-direction: column; 
            align-items: center; justify-content: center; z-index: 2;
        }
        .lock-badge { 
            background: #333; color: #fff; padding: 5px 15px; border-radius: 20px; 
            font-size: 12px; margin-bottom: 10px; display: flex; align-items: center; gap: 5px;
        }

        /* æ”¯ä»˜é¢æ¿ */
        .pay-panel { 
            border: 2px solid var(--gold); border-radius: 12px; padding: 20px 15px; 
            background: #FFFCF7; text-align: center; position: relative; overflow: hidden;
        }
        .tag-offer { 
            position: absolute; top: 0; left: 0; background: var(--red-urgency); color: white; 
            font-size: 11px; padding: 3px 8px; border-bottom-right-radius: 8px; font-weight: bold;
        }
        .price-box { margin: 10px 0 20px; }
        .price-curr { color: var(--red-urgency); font-size: 32px; font-weight: 800; }
        .price-old { color: #999; text-decoration: line-through; font-size: 14px; margin-left: 5px; }
        .price-tip { font-size: 11px; color: #D4AF37; margin-top: -5px; font-weight: bold; }
        
        .pay-btns { display: flex; gap: 10px; flex-direction: column; }
        .btn-pay { 
            padding: 12px; border-radius: 6px; border: none; color: white; font-weight: bold; 
            font-size: 14px; cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 8px;
            text-decoration: none;
        }
        .btn-ali { background: #1677FF; }
        .btn-wx { background: #07C160; }
        
        .qr-area { margin-top: 15px; border-top: 1px dashed #E2C08D; padding-top: 15px; }
        .qr-img { width: 120px; border-radius: 6px; border: 1px solid #EEE; }

        /* å€’è®¡æ—¶æµ®çª— */
        .sticky-countdown {
            position: fixed; top: 0; left: 0; width: 100%; background: #FFF1F0; 
            color: #CF1322; text-align: center; padding: 8px; font-size: 12px; font-weight: bold;
            z-index: 100; box-shadow: 0 2px 10px rgba(0,0,0,0.05); display: none;
        }

        /* æˆåŠŸé¡µ */
        .success-box { text-align: center; padding: 30px 0; }
        .pan-card { background: #E8F5E9; border: 1px solid #2E7D32; border-radius: 10px; padding: 15px; margin: 20px 0; text-align: left; }
        .copy-btn { background: #2E7D32; color: white; border: none; padding: 8px 20px; border-radius: 20px; font-size: 13px; font-weight: bold; float: right; }

        /* ç®¡ç†å‘˜ */
        .admin-entry { text-align: center; margin-top: 30px; font-size: 12px; color: #DDD; }
    </style>
</head>
<body>

<div id="stickyCountdown" class="sticky-countdown">âš¡ é™æ—¶ç‰¹æƒ å€’è®¡æ—¶ï¼š<span id="timer">15:00</span> æ¢å¤åŸä»· Â¥199</div>

<div class="container">
    
    <div id="homePage" class="card">
        <div class="header">
            <div class="stat-bar"><div class="stat-dot"></div> ä»Šæ—¥å·²æœ‰ 842 äººå‚ä¸è¯„ä¼°</div>
            <h1>â­ ç¤¾ä¼šåŒ–ç¨‹åº¦æ·±åº¦è¯„ä¼°</h1>
            <p>æ´å¯Ÿäººæƒ…ä¸–æ•… Â· æŒæ¡ç¤¾äº¤æ½œè§„åˆ™</p>
            <div class="badge">2025å®æˆ˜ç‰ˆ</div>
        </div>

        <div class="dimensions-grid">
            <div class="dim-card"><span class="dim-icon">ğŸ‘ï¸</span><div class="dim-name">äººæƒ…æ´å¯Ÿ</div></div>
            <div class="dim-card"><span class="dim-icon">ğŸ¯</span><div class="dim-name">è¾¹ç•ŒæŒæ§</div></div>
            <div class="dim-card"><span class="dim-icon">âš–ï¸</span><div class="dim-name">åˆ©ç›Šå¹³è¡¡</div></div>
            <div class="dim-card"><span class="dim-icon">ğŸ­</span><div class="dim-name">æƒ…ç»ªç®¡ç†</div></div>
        </div>

        <div class="feature-box">
            <ul class="feature-list">
                <li>ç²¾å‡†é‡åŒ–æ‚¨çš„ <strong>"ç¤¾ä¼šåŒ–æˆç†Ÿåº¦"</strong></li>
                <li>ç”Ÿæˆ 4ç»´ æ ¸å¿ƒèƒ½åŠ›é›·è¾¾å›¾</li>
                <li><span class="highlight-red">è§£é” 100ä¸‡å­—ã€Šç¤¾ä¼šåŒ–å®æˆ˜æ‰‹å†Œã€‹</span></li>
                <li>è·å–é’ˆå¯¹æ€§ <strong>"é¿å‘æŒ‡å—"</strong></li>
            </ul>
        </div>

        <div class="input-group">
            <input type="text" id="cardInput" placeholder="è¯·è¾“å…¥æµ‹è¯„å¡å·">
        </div>
        <button class="btn-primary btn-pulse" onclick="startTest()">å¼€å§‹ä¸“ä¸šè¯„ä¼°</button>
        <div id="homeError" style="color:red; font-size:12px; text-align:center; margin-top:8px;"></div>
        
        <div class="admin-entry" onclick="showAdmin()">ç®¡ç†å‘˜å…¥å£</div>
    </div>

    <div id="testPage" class="card hidden">
        <div style="display:flex; justify-content:space-between; color:#999; font-size:12px;">
            <span id="progressText">è¿›åº¦ 1/40</span>
            <span>å•é€‰</span>
        </div>
        <div class="progress-bar"><div class="progress-fill" id="progressBar"></div></div>
        <div class="question-text" id="qText">é¢˜ç›®åŠ è½½ä¸­...</div>
        <div id="optionsBox"></div>
        <div class="nav-buttons">
            <button class="nav-btn btn-prev" onclick="prevQ()" id="prevBtn" style="visibility:hidden">ä¸Šä¸€é¢˜</button>
            <button class="nav-btn btn-next" onclick="nextQ()">ä¸‹ä¸€é¢˜</button>
        </div>
    </div>

    <div id="resultPage" class="card hidden" style="padding:0; overflow:hidden;">
        <div class="result-header">
            <div class="score-label">æ‚¨çš„ç¤¾ä¼šåŒ–ç»¼åˆå¾—åˆ†</div>
            <div class="score-val" id="simpleScore">--</div>
            <div class="score-badge" id="simpleLevel">è¯„ä¼°ä¸­</div>
        </div>

        <div style="padding: 20px;">
            <div class="pain-card">
                <div class="pain-title">âš ï¸ æ½œä¼å±æœºé¢„è­¦</div>
                <div class="pain-text" id="weaknessText">åˆ†æä¸­...</div>
            </div>

            <div class="chart-box">
                <canvas id="radarChart"></canvas>
            </div>

            <div class="locked-wrapper" onclick="scrollToPay()">
                <div class="lock-overlay">
                    <div class="lock-badge">ğŸ”’ æ·±åº¦æŠ¥å‘Šå·²ç”Ÿæˆ</div>
                    <div style="font-weight:bold; font-size:14px; color:#333;">è§£é”æŸ¥çœ‹å®Œæ•´ 100ä¸‡å­— è§£å†³æ–¹æ¡ˆ</div>
                    <div style="font-size:12px; color:#666; margin-top:5px;">å«ï¼šé¿å‘æŒ‡å— + æ²Ÿé€šè¯æœ¯ + å®æˆ˜æ‰‹å†Œ</div>
                </div>
                <div class="blur-content">
                    <p>æ ¹æ®æ‚¨çš„æµ‹è¯„ç»“æœï¼Œæ‚¨åœ¨ã€åˆ©ç›Šåšå¼ˆã€‘åœºæ™¯ä¸‹å­˜åœ¨æ˜æ˜¾çš„è®¤çŸ¥ç›²åŒº...</p>
                    <p>è¿™å¯èƒ½å¯¼è‡´æ‚¨åœ¨èŒåœºä¸­ï¼š1. å¹²æœ€å¤šçš„æ´»èƒŒæœ€å¤§çš„é”… 2. å®¹æ˜“è¢«è¾¹ç¼˜åŒ–...</p>
                    <p>å»ºè®®ç«‹å³é‡‡å–ä»¥ä¸‹3ä¸ªè¡¥æ•‘æªæ–½ï¼š1. å»ºç«‹...</p>
                </div>
            </div>

            <div id="paySection" class="pay-panel">
                <div class="tag-offer">é™æ—¶ç‰¹æƒ </div>
                <div class="price-box">
                    <span class="price-curr">Â¥19.9</span>
                    <span class="price-old">Â¥199</span>
                    <div class="price-tip">ğŸ”¥ ä»…å‰© 15 ä»½ä¼˜æƒ åé¢</div>
                </div>

                <div class="pay-btns">
                    <a href="https://qr.alipay.com/tsx15981nt9c4aydmvo2h3d" class="btn-pay btn-ali">
                        <span>âš¡ æ”¯ä»˜å®ä¸€é”®è§£é”</span>
                    </a>
                    <a href="javascript:void(0);" onclick="showWxQr()" class="btn-pay btn-wx">
                        <span>âš¡ å¾®ä¿¡æ”¯ä»˜è§£é”</span>
                    </a>
                </div>

                <div class="qr-area" id="wxQrArea" style="display:none;">
                    <div style="font-size:12px; margin-bottom:10px; color:#666;">è¯·æˆªå±ä¿å­˜äºŒç»´ç  -> æ‰“å¼€å¾®ä¿¡æ‰«ä¸€æ‰«</div>
                    <img src="wechat_qrcode.jpg" class="qr-img">
                </div>

                <div style="margin-top:20px; border-top:1px dashed #E2C08D; padding-top:15px;">
                    <div style="font-size:13px; font-weight:bold; margin-bottom:10px; color:#5D4037;">å·²æœ‰è´¦å·ï¼Ÿæˆ–è½¬è´¦åï¼š</div>
                    <label for="fileInput" class="btn-primary" style="background:#5D4037; font-size:14px; width:auto; display:inline-block; padding:8px 20px;">
                        ğŸ“¸ ä¸Šä¼ ä»˜æ¬¾æˆªå›¾å–è´§
                    </label>
                    <input type="file" id="fileInput" accept="image/*" style="display:none;" onchange="handleUpload(event)">
                </div>
            </div>

            <div class="recruit-card">
                <div style="font-size:14px; font-weight:bold; color:var(--primary);">ğŸ“¢ æ‹›å‹Ÿï¼šå¿ƒç†æµ‹è¯•é¡¹ç›®å­¦å¾’</div>
                <div style="font-size:12px; color:#666; margin:5px 0;">è·Ÿç€åšé¡¹ç›® Â· é•¿æœŸå¸¦æ•™ Â· æµé‡å˜ç°</div>
                <div class="recruit-copy-box">
                    <span style="font-weight:bold; color:#333; font-size:13px;">HCH91178</span>
                    <button class="btn-copy-orange" onclick="copyWx()">å¤åˆ¶å¾®ä¿¡</button>
                </div>
            </div>
        </div>
    </div>

    <div id="successPage" class="card hidden">
        <div class="success-box">
            <div style="font-size:50px;">âœ…</div>
            <h2 style="color:#2E7D32; margin:10px 0;">æ”¯ä»˜æˆåŠŸ</h2>
            <p style="color:#666; font-size:14px;">æ‚¨çš„ä¸“å±æå‡æ–¹æ¡ˆå·²ç”Ÿæˆ</p>
        </div>

        <div class="report-module">
            <div class="module-title" style="color:var(--primary); font-weight:bold; border-bottom:1px solid #EEE; padding-bottom:10px;">ğŸ“Š è¯¦ç»†ç»´åº¦åˆ†æ</div>
            <div id="fullDimensionAnalysis" style="margin-top:15px;"></div>
        </div>

        <div class="pan-card">
            <div style="font-weight:bold; color:#2E7D32; margin-bottom:10px;">ğŸ 100ä¸‡å­—ã€Šç¤¾ä¼šåŒ–æ‰‹å†Œã€‹é¢†å–</div>
            <div style="font-size:13px; color:#555; margin-bottom:5px;">ç½‘ç›˜é“¾æ¥ï¼š<span id="panLinkTxt">https://pan.baidu.com/s/xxxxx</span></div>
            <div style="font-size:13px; color:#555; margin-bottom:15px;">æå–ç ï¼š<span id="panCodeTxt" style="font-weight:bold; color:#D35400;">8888</span></div>
            <button class="copy-btn" onclick="copyAllInfo()">ä¸€é”®å¤åˆ¶å…¨éƒ¨</button>
            <div style="clear:both;"></div>
        </div>
        
        <div style="text-align:center; font-size:12px; color:#999; margin-top:20px;">
            æœ‰é—®é¢˜è¯·è”ç³»å®¢æœå¾®ä¿¡ï¼šHCH91178
        </div>
    </div>
    
    <div id="adminPage" class="card hidden">
        <h3 style="text-align:center;">åå°ç®¡ç†</h3>
        <input type="password" id="adminPwd" placeholder="å¯†ç " style="width:100%; padding:10px; margin:10px 0; border:1px solid #ddd;">
        <button onclick="checkAdmin()" class="btn-primary" style="padding:10px;">ç™»å½•</button>
        <div id="adminContent" style="margin-top:20px;"></div>
        <div style="text-align:center; margin-top:20px; color:#999;" onclick="location.reload()">è¿”å›</div>
    </div>

</div>

<script>
    const CONFIG = {
        MASTER_CODE: "GEMINI-MASTER",
        ADMIN_PWD: "lss900201",
        SERVER_KEY: "SCT303445TGU9j8Q5VLg6rT7eryLe8L41v",
        PAN_LINK: "https://pan.baidu.com/s/1TPexZexAwxC-is2dfD_LeA",
        PAN_CODE: "8888",
        ALIPAY_URL: "https://qr.alipay.com/tsx15981nt9c4aydmvo2h3d"
    };

    const questions = [
        {t:"é¢†å¯¼è¯´'çœ‹ç€åŠ'æ—¶ï¼Œæˆ‘èƒ½å¬å‡ºæ˜¯åœ¨æ”¾æƒè¿˜æ˜¯è¯•æ¢", d:0},
        {t:"é¥­å±€ä¸Šèƒ½è¿…é€Ÿåˆ¤æ–­è°æ˜¯æ ¸å¿ƒäººç‰©", d:0},
        {t:"èƒ½å¬æ‡‚æœ‹å‹'éšä¾¿'èƒŒåçš„çœŸå®éœ€æ±‚", d:0},
        {t:"ç»å¸¸æŠŠåˆ«äººçš„å®¢å¥—è¯å½“çœŸ", d:0, r:true},
        {t:"èƒ½é€šè¿‡ç©¿ç€å¤§è‡´åˆ¤æ–­å¯¹æ–¹æ€§æ ¼", d:0},
        {t:"æ°”æ°›å°´å°¬æ—¶æˆ‘æ˜¯æœ€åä¸€ä¸ªå‘ç°çš„", d:0, r:true},
        {t:"èƒ½åˆ†æ¸…'æ”¹å¤©åƒé¥­'æ˜¯å®¢å¥—è¿˜æ˜¯çœŸé‚€", d:0},
        {t:"èƒ½çœ‹æ¸…èŒåœºä¸­è°å’Œè°æ˜¯ä¸€ä¼™çš„", d:0},
        {t:"åˆ«äººæ¬²è¨€åˆæ­¢æ—¶çŸ¥é“è¯¥è¿½é—®è¿˜æ˜¯é—­å˜´", d:0},
        {t:"ä¸æ‡‚ä¸ºä»€ä¹ˆæœ‰äº›äººæ˜æ˜è®¨åŒå¯¹æ–¹è¿˜èƒ½è°ˆç¬‘é£ç”Ÿ", d:0, r:true},
        {t:"çŸ¥é“å¼‚æ€§é—´ä»€ä¹ˆç©ç¬‘ä¸èƒ½å¼€", d:1},
        {t:"çƒ­å¿ƒå¸®å¿™å¸¸è¢«å«Œå¤šç®¡é—²äº‹", d:1, r:true},
        {t:"æ‡‚å¾—ä½“é¢æ‹’ç»æ— ç†è¦æ±‚", d:1},
        {t:"æ·±å¤œç»™ä¸ç†ŸåŒäº‹å‘æ¶ˆæ¯è§‰å¾—æ²¡é—®é¢˜", d:1, r:true},
        {t:"åšå®¢çŸ¥é“ä»€ä¹ˆæ—¶å€™è¯¥å‘Šè¾", d:1},
        {t:"ä¸éšæ„æ‰“å¬æœ‹å‹éšç§", d:1},
        {t:"å…¬å…±åœºåˆå¤§å£°æ‰“ç”µè¯äº‹åæ‰è§‰ä¸å¦¥", d:1, r:true},
        {t:"çŸ¥é“å“ªäº›è¯é¢˜æ˜¯èŒåœºç¦å¿Œ", d:1},
        {t:"èƒ½æŠŠæ¡ä¸é¢†å¯¼ç›¸å¤„çš„å°Šå‘åˆ†å¯¸", d:1},
        {t:"å€Ÿæœ‹å‹å°é’±ç»å¸¸å¿˜è®°è¿˜", d:1, r:true},
        {t:"æ€•å¾—ç½ªäººå¸¸åœ¨åˆ©ç›Šä¸Šåƒå“‘å·´äº", d:2, r:true},
        {t:"ä¸çˆ±å å°ä¾¿å®œï¼Œæ‡‚å…è´¹çš„æœ€è´µ", d:2},
        {t:"æ±‚äººåŠäº‹å…ˆæƒ³å¥½èƒ½ç»™å¯¹æ–¹ä»€ä¹ˆä»·å€¼", d:2},
        {t:"è§‰å¾—è°ˆé’±ä¼¤æ„Ÿæƒ…å°½é‡å›é¿", d:2, r:true},
        {t:"å†²çªæ—¶èƒ½æ‰¾åˆ°åŒèµ¢æ–¹æ¡ˆ", d:2},
        {t:"æ‡‚é€ç¤¼çš„è‰ºæœ¯", d:2},
        {t:"æ„¿ä¸ºé•¿æœŸå…³ç³»ç‰ºç‰²çŸ­æœŸåˆ©ç›Š", d:2},
        {t:"å—äººæ©æƒ æ— æ³•å›æŠ¥ä¼šç„¦è™‘", d:2},
        {t:"çŸ¥é“ä½•æ—¶è¯¥è£…å‚»ä¿æŠ¤åˆ©ç›Š", d:2},
        {t:"èƒ½åœ¨å¤æ‚å±€åŠ¿æ‰¾åˆ°æœ‰åˆ©ä½ç½®", d:2},
        {t:"è¢«å½“ä¼—æ‰¹è¯„èƒ½å‹ä½ç«å…ˆè§£å†³é—®é¢˜", d:3},
        {t:"å¿ƒæƒ…ä¸å¥½å¸¸è¿æ€’äº²è¿‘çš„äºº", d:3, r:true},
        {t:"æ„¤æ€’æ—¶èƒ½æ§åˆ¶ä¸è¯´ç‹ è¯", d:3},
        {t:"å¾ˆå®¹æ˜“è¢«åˆ«äººæƒ…ç»ªæ„ŸæŸ“å¸¦è·‘", d:3, r:true},
        {t:"é¢å¯¹æŒ‘è¡…èƒ½ä¿æŒå†·é™", d:3},
        {t:"å†²åŠ¨å†³å®šåç»å¸¸åæ‚”", d:3, r:true},
        {t:"èƒ½æ•é”å¯Ÿè§‰å¹¶æ’è§£è´Ÿé¢æƒ…ç»ª", d:3},
        {t:"é«˜å‹ä¸‹ç»å¸¸å´©æºƒæ— æ³•æ€è€ƒ", d:3, r:true},
        {t:"ä¸ºé¡¾å…¨å¤§å±€èƒ½å¿å—å§”å±ˆ", d:3},
        {t:"æ“…é•¿ç”¨å¹½é»˜åŒ–è§£å°´å°¬", d:3}
    ];

    let state = { qIdx: 0, ans: [], code: '' };

    function startTest() {
        const val = document.getElementById('cardInput').value.trim();
        if(!val) return document.getElementById('homeError').innerText = 'è¯·è¾“å…¥å¡å·';
        // ç®€å•å¡å·éªŒè¯
        if(val.length < 4 && val !== CONFIG.MASTER_CODE) return document.getElementById('homeError').innerText = 'å¡å·æ ¼å¼é”™è¯¯';
        
        state.code = val;
        document.getElementById('homePage').classList.add('hidden');
        document.getElementById('testPage').classList.remove('hidden');
        renderQ();
    }

    function renderQ() {
        const q = questions[state.qIdx];
        document.getElementById('qText').innerText = `${state.qIdx+1}. ${q.t}`;
        document.getElementById('progressText').innerText = `è¿›åº¦ ${state.qIdx+1}/40`;
        document.getElementById('progressBar').style.width = ((state.qIdx+1)/40*100) + '%';
        document.getElementById('prevBtn').style.visibility = state.qIdx === 0 ? 'hidden' : 'visible';
        
        let html = '';
        ['éå¸¸ä¸ç¬¦','æ¯”è¾ƒä¸ç¬¦','ä¸ç¡®å®š','æ¯”è¾ƒç¬¦åˆ','éå¸¸ç¬¦åˆ'].forEach((txt, i) => {
            const isSel = state.ans[state.qIdx] === (i+1) ? 'selected' : '';
            html += `<div class="option ${isSel}" onclick="selectOpt(${i+1})">${txt}</div>`;
        });
        document.getElementById('optionsBox').innerHTML = html;
    }

    function selectOpt(val) {
        state.ans[state.qIdx] = val;
        renderQ();
        setTimeout(() => { nextQ(true); }, 250);
    }

    function nextQ(isAuto = false) {
        if(!isAuto && !state.ans[state.qIdx]) return alert('è¯·é€‰æ‹©');
        if(isAuto && !state.ans[state.qIdx]) return;
        
        if(state.qIdx < 39) {
            state.qIdx++; renderQ();
        } else {
            calcResult();
        }
    }

    function prevQ() { if(state.qIdx > 0) { state.qIdx--; renderQ(); } }

    function calcResult() {
        let scores = [0,0,0,0];
        questions.forEach((q,i) => { 
            let v = state.ans[i] || 3; 
            if(q.r) v = 6 - v; 
            scores[q.d] += v; 
        });
        scores = scores.map(s => s * 2); // è½¬ä¸ºç™¾åˆ†åˆ¶
        const total = Math.round(scores.reduce((a,b)=>a+b,0)/4);
        let level = total>80?'ç¤¾äº¤é«˜æ‰‹':(total>60?'è¿›é˜¶ç©å®¶':'ç¤¾äº¤å°ç™½');

        document.getElementById('testPage').classList.add('hidden');
        document.getElementById('resultPage').classList.remove('hidden');
        document.getElementById('stickyCountdown').style.display = 'block'; // æ˜¾ç¤ºå€’è®¡æ—¶
        startTimer();

        document.getElementById('simpleScore').innerText = total;
        document.getElementById('simpleLevel').innerText = level;

        const names = ['äººæƒ…æ´å¯Ÿ','è¾¹ç•ŒæŒæ§','åˆ©ç›Šå¹³è¡¡','æƒ…ç»ªç®¡ç†'];
        const minVal = Math.min(...scores);
        const minIdx = scores.indexOf(minVal);
        
        // ç”Ÿæˆç—›ç‚¹æ–‡æ¡ˆ
        const painPoints = {
            0: "æ‚¨åœ¨ã€äººæƒ…æ´å¯Ÿã€‘æ–¹é¢å­˜åœ¨çŸ­æ¿ï¼Œå®¹æ˜“å› â€œçœ‹ä¸æ‡‚çœ¼è‰²â€è€Œå¾—ç½ªäººï¼Œå¸¸å¸¸äº‹åæ‰å‘è§‰è¢«åˆ©ç”¨ã€‚",
            1: "æ‚¨åœ¨ã€è¾¹ç•ŒæŒæ§ã€‘æ–¹é¢è¾ƒå¼±ï¼Œå®¹æ˜“æˆä¸ºâ€œè€å¥½äººâ€ï¼Œå› ä¸æ‡‚æ‹’ç»è€Œè€—è´¹å¤§é‡ç²¾åŠ›ã€‚",
            2: "æ‚¨åœ¨ã€åˆ©ç›Šå¹³è¡¡ã€‘æ–¹é¢ç¼ºä¹ç»éªŒï¼Œå¸¸åœ¨åˆä½œä¸­åƒæš—äºï¼Œä»˜å‡ºä¸å›æŠ¥ä¸æˆæ­£æ¯”ã€‚",
            3: "æ‚¨åœ¨ã€æƒ…ç»ªç®¡ç†ã€‘æ–¹é¢æ³¢åŠ¨è¾ƒå¤§ï¼Œå®¹æ˜“å› ä¸€æ—¶å†²åŠ¨ç ´åé•¿æœŸç§¯ç´¯çš„äººè„‰å…³ç³»ã€‚"
        };
        document.getElementById('weaknessText').innerText = painPoints[minIdx] + " è¿™ç§çŠ¶æ€è‹¥æŒç»­ï¼Œå°†ä¸¥é‡é˜»ç¢æ‚¨çš„èŒåœºæ™‹å‡ã€‚";

        drawChart('radarChart', scores);
        
        // ä¿å­˜æ•°æ®ä¾›æˆåŠŸé¡µä½¿ç”¨
        window.fullData = { scores, names, total, level };
        window.scrollTo(0,0);
    }

    function drawChart(id, data) {
        const ctx = document.getElementById(id).getContext('2d');
        if(window[id] instanceof Chart) window[id].destroy();
        window[id] = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['æ´å¯Ÿ','è¾¹ç•Œ','åˆ©ç›Š','æƒ…ç»ª'],
                datasets: [{
                    label: 'èƒ½åŠ›å€¼', data: data, backgroundColor: 'rgba(139, 110, 78, 0.2)',
                    borderColor: '#8B6E4E', borderWidth: 2, pointBackgroundColor: '#8B6E4E'
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                scales: { r: { min: 0, max: 100, ticks: {display:false}, pointLabels: {fontSize: 12} } },
                plugins: { legend: {display:false} }
            }
        });
    }

    function startTimer() {
        let m = 15, s = 0;
        setInterval(() => {
            if(s === 0) {
                if(m === 0) return;
                m--; s = 59;
            } else { s--; }
            document.getElementById('timer').innerText = `${m}:${s<10?'0'+s:s}`;
        }, 1000);
    }

    function scrollToPay() { document.getElementById('paySection').scrollIntoView({behavior:'smooth'}); }
    function scrollToQR() { document.getElementById('paySection').scrollIntoView({behavior:'smooth'}); } // ç®€åŒ–è·³è½¬
    function showWxQr() { document.getElementById('wxQrArea').style.display = 'block'; }
    function aliPay() { window.location.href = CONFIG.ALIPAY_URL; }

    function handleUpload(e) {
        if(e.target.files.length === 0) return;
        document.querySelector('label[for="fileInput"]').innerText = 'â³ æ­£åœ¨æ ¸éªŒ...';
        fetch(`https://sctapi.ftqq.com/${CONFIG.SERVER_KEY}.send`, {
            method: 'POST', headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ title: 'ğŸ’°æ–°è®¢å•-ç¤¾ä¼šåŒ–-19.9', desp: `å¡å·:${state.code}` })
        }).catch(()=>{});
        
        setTimeout(() => {
            document.getElementById('resultPage').classList.add('hidden');
            document.getElementById('stickyCountdown').style.display = 'none';
            document.getElementById('successPage').classList.remove('hidden');
            renderFullReport();
            window.scrollTo(0,0);
        }, 1500);
    }

    function renderFullReport() {
        const d = window.fullData;
        document.getElementById('panLinkTxt').innerText = CONFIG.PAN_LINK;
        document.getElementById('panCodeTxt').innerText = CONFIG.PAN_CODE;
        
        let html = '';
        d.names.forEach((n, i) => {
            html += `<div style="margin-bottom:10px;">
                <div style="display:flex;justify-content:space-between;font-size:13px;font-weight:bold;"><span>${n}</span><span>${d.scores[i]}åˆ†</span></div>
                <div style="height:6px;background:#EEE;border-radius:3px;margin-top:5px;"><div style="height:100%;width:${d.scores[i]}%;background:#8B6E4E;border-radius:3px;"></div></div>
            </div>`;
        });
        document.getElementById('fullDimensionAnalysis').innerHTML = html;
    }

    function copyAllInfo() {
        navigator.clipboard.writeText(`é“¾æ¥: ${CONFIG.PAN_LINK} æå–ç : ${CONFIG.PAN_CODE}`).then(()=>alert('å¤åˆ¶æˆåŠŸï¼Œè¯·æ‰“å¼€ç™¾åº¦ç½‘ç›˜App'));
    }
    
    function copyWx() {
        navigator.clipboard.writeText("HCH91178").then(()=>{
            alert('å¾®ä¿¡å·å·²å¤åˆ¶ï¼å³å°†è·³è½¬å¾®ä¿¡...');
            setTimeout(()=>{ window.location.href="weixin://"; }, 500);
        });
    }

    function showAdmin() { document.getElementById('homePage').classList.add('hidden'); document.getElementById('adminPage').classList.remove('hidden'); }
    function checkAdmin() {
        if(document.getElementById('adminPwd').value === CONFIG.ADMIN_PWD) {
            document.getElementById('adminContent').innerHTML = 'ç™»å½•æˆåŠŸ';
        } else { alert('å¯†ç é”™è¯¯'); }
    }
</script>
</body>
</html>
