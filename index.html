<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¹´ä¸Šå¹´ä¸‹æ‹çˆ±å€¾å‘æµ‹è¯• - å‘ç°ä½ çš„å…³ç³»è§’è‰²åŸå‹</title>
    <script src="https://cdn.bootcdn.net/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <style>
        /* ================= è§†è§‰ç³»ç»Ÿï¼šç„¦ç³–å¥¶æ²¹é£ ================= */
        :root {
            --primary: #A07F56;       /* ä¸»è‰²ï¼šç„¦ç³– */
            --bg-body: #FBF8F2;       /* èƒŒæ™¯ï¼šå¥¶æ²¹ */
            --bg-card: #FFFFFF;
            --accent: #D55D30;        /* å¼ºè°ƒè‰²ï¼šé™¶åœŸæ©™ */
            --btn-red: #FF4D4F;       /* è§£é”æŒ‰é’®çº¢ */
            --success: #52c41a;       /* æˆåŠŸç»¿ */
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #FBF8F2 0%, #FAF0E6 100%);
            min-height: 100vh;
            padding: 10px; /* V10.1 å‡å°‘Bodyå†…è¾¹è· */
            color: #333;
            line-height: 1.5; /* V10.1 ç¨å¾®å‡å°è¡Œé«˜ */
        }

        .container { max-width: 800px; margin: 0 auto; padding-bottom: 40px; /* V10.1 å‡å°‘åº•éƒ¨ç•™ç™½ */ }
        .hidden { display: none !important; }

        .card {
            background: white;
            border-radius: 16px; /* V10.1 ç¨å¾®å‡å°åœ†è§’ */
            padding: 20px; /* V10.1 å‡å°‘å¡ç‰‡å†…è¾¹è· */
            box-shadow: 0 5px 20px rgba(160, 127, 86, 0.06);
            margin-bottom: 15px; /* V10.1 å‡å°‘å¡ç‰‡é—´è· */
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* å¤´éƒ¨ä¸è¾“å…¥ */
        .header { text-align: center; margin-bottom: 20px; /* V10.1 å‡å°‘å¤´éƒ¨é—´è· */ }
        .header h1 { color: var(--primary); font-size: 1.6em; margin-bottom: 5px; font-weight: 800; }
        .header p { color: #666; font-size: 0.9em; margin-bottom: 8px;}
        .badge { background: #EFEBE5; color: var(--primary); padding: 3px 10px; border-radius: 20px; font-size: 0.75em; font-weight: bold; }

        .grid-box { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 10px; /* V10.1 å‡å°‘ç½‘æ ¼é—´è· */
            margin: 15px 0; /* V10.1 å‡å°‘ä¸Šä¸‹é—´è· */
        }
        .grid-item {
            background: #FFFBF5;
            padding: 12px; /* V10.1 å‡å°‘å†…è¾¹è· */
            border-radius: 10px;
            text-align: center;
            border: 1px solid #F5E8D6;
        }
        .grid-icon { font-size: 22px; margin-bottom: 4px; display: block; }
        .grid-text { font-weight: bold; color: var(--primary); font-size: 0.85em; }

        .feature-list {
            background: #F9F9F9;
            padding: 15px; /* V10.1 å‡å°‘å†…è¾¹è· */
            border-radius: 10px;
            font-size: 0.9em;
            color: #555;
            margin-bottom: 20px; /* V10.1 å‡å°‘é—´è· */
        }
        .feature-item { margin-bottom: 6px; display: flex; align-items: center; }
        .check { color: var(--primary); margin-right: 6px; font-weight: bold; }

        .input-group input {
            width: 100%; padding: 14px; border: 2px solid #F5E8D6; border-radius: 50px;
            font-size: 1.1em; text-align: center; -webkit-appearance: none; margin-bottom: 12px; /* V10.1 */
            background: #FFF;
        }
        
        .btn {
            width: 100%; padding: 14px; border: none; border-radius: 50px; /* V10.1 æŒ‰é’®é«˜åº¦å¾®è°ƒ */
            font-size: 1.15em; font-weight: bold; cursor: pointer; display: block;
        }
        .btn-primary { 
            background: linear-gradient(135deg, #A07F56 0%, #856847 100%); 
            color: white; 
            box-shadow: 0 6px 15px rgba(160, 127, 86, 0.25); 
        }
        .btn-secondary { 
            background: white; color: var(--primary); border: 2px solid var(--primary); margin-top: 12px; /* V10.1 */
        }

        /* ç­”é¢˜é¡µ */
        .progress-bar { height: 6px; background: #F5E8D6; border-radius: 3px; margin-bottom: 15px; }
        .progress-fill { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s; border-radius: 3px; }
        .question-text { font-size: 1.2em; font-weight: bold; margin-bottom: 20px; line-height: 1.4; color: #333; min-height: 60px; /* V10.1 ç´§å‡‘åŒ– */ }
        .option {
            padding: 15px; background: #FDF8F2; border: 1px solid #F5E8D6; /* V10.1 å‡å°‘é€‰é¡¹å†…è¾¹è· */
            border-radius: 10px; margin-bottom: 10px; cursor: pointer; color: #555; transition: all 0.2s; font-size: 1em;
        }
        .option.selected { background: var(--primary); color: white; border-color: var(--primary); }
        
        .nav-box { display: flex; gap: 10px; margin-top: 20px; /* V10.1 */ }
        .nav-btn {
            flex: 1; padding: 12px; border-radius: 10px; border: none; font-size: 0.95em; font-weight: bold; cursor: pointer;
        }
        .btn-prev { background: #EEE; color: #666; }
        .btn-next { background: var(--primary); color: white; }

        /* ç»“æœé¡µ */
        .result-banner {
            background: linear-gradient(135deg, #A07F56 0%, #856847 100%);
            color: white; padding: 25px 15px; /* V10.1 å‡å°‘å†…è¾¹è· */
            border-radius: 12px; text-align: center;
        }
        .rpi-icon { font-size: 4em; margin: 8px 0; text-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .rpi-name { font-size: 1.6em; font-weight: bold; margin-bottom: 4px;}
        
        .chart-box { height: 300px; margin: 15px 0; position: relative; /* V10.1 å‡å°‘é«˜åº¦å’Œé—´è· */ } 

        .score-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 15px; /* V10.1 */ }
        .score-card { background: #FFFBF5; padding: 10px 15px; border-radius: 8px; border-left: 3px solid var(--primary); /* V10.1 ç´§å‡‘å†…è¾¹è· */ }
        .score-label { color: var(--primary); font-size: 0.85em; font-weight: bold; }
        .score-val { font-size: 1.3em; font-weight: bold; color: #333; margin-top: 2px; }

        /* å…è´¹å†…å®¹å¢å¼º */
        .free-section { margin: 20px 0; /* V10.1 å‡å°‘æ¿å—é—´è· */ }
        .section-title { font-size: 1.1em; font-weight: bold; color: #333; border-left: 4px solid var(--primary); padding-left: 10px; margin-bottom: 10px; /* V10.1 */ }
        
        .long-text-analysis, .text-block {
            font-size: 0.9em; color: #444; line-height: 1.7; 
            background: #FAFAFA; padding: 15px; border-radius: 10px; 
            text-align: justify; margin-bottom: 10px; border: 1px solid #EEE; /* V10.1 */
        }

        .tag-cloud { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 10px; }
        .tag { background: #EFEBE5; color: #5D4037; padding: 5px 12px; border-radius: 6px; font-size: 0.85em; font-weight: bold; }

        /* 16å‹æ€»è§ˆæ ·å¼ */
        .all-types-grid {
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; margin-top: 10px; /* V10.1 */
        }
        .type-item {
            background: #FFF; border: 1px solid #EFEBE5; border-radius: 6px;
            padding: 6px 2px; text-align: center; font-size: 0.7em;
            position: relative; color: #666; transition: all 0.3s;
        }
        .type-item.active {
            border-color: var(--primary); color: var(--primary); background: #FFFBF5;
            font-weight: bold; box-shadow: 0 2px 6px rgba(160, 127, 86, 0.15);
            transform: scale(1.03); z-index: 2;
        }
        .type-star {
            position: absolute; top: -4px; right: -4px; font-size: 1em;
            color: #FFD700; text-shadow: 0 1px 1px rgba(0,0,0,0.1); z-index: 3;
        }
        .type-icon-sm { font-size: 1.4em; display: block; margin-bottom: 3px; }

        /* è§£é”é®ç½© */
        .locked-section {
            position: relative; margin-top: 25px; border-radius: 12px; /* V10.1 */
            overflow: hidden; border: 1px solid #eee; background: #fff;
        }
        .blur-content {
            filter: blur(6px); user-select: none; padding: 15px; /* V10.1 */
            background: #fff; opacity: 0.5; font-size: 0.9em; line-height: 1.6;
        }
        .lock-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: rgba(255, 255, 255, 0.5); z-index: 10;
        }
        .lock-icon { font-size: 2.5em; margin-bottom: 8px; /* V10.1 */ }
        .lock-text { font-size: 1em; font-weight: bold; color: #333; margin-bottom: 15px; /* V10.1 */ }
        .unlock-btn-red {
            background: linear-gradient(135deg, #FF4D4F 0%, #D32F2F 100%);
            color: white; padding: 12px 30px; border-radius: 50px; /* V10.1 */
            font-size: 1.05em; font-weight: bold; border: none;
            cursor: pointer; box-shadow: 0 5px 15px rgba(211, 47, 47, 0.3);
            animation: pulse-red 2s infinite;
        }
        @keyframes pulse-red { 0% {transform: scale(1);} 50% {transform: scale(1.05);} 100% {transform: scale(1);} }

        /* è§£é”åŒº */
        .unlock-box {
            background: #FFF; border-top: 1px solid #eee; padding: 20px 15px; /* V10.1 */
            border-radius: 0 0 12px 12px; text-align: center; margin-top: -10px;
        }
        .price { color: var(--accent); font-size: 2.4em; font-weight: bold; margin: 8px 0; line-height: 1; /* V10.1 */ }
        .price s { color: #999; font-size: 0.45em; font-weight: normal; margin-left: 5px; }
        
        .pay-btn {
            display: flex; align-items: center; justify-content: center; width: 100%; padding: 12px; /* V10.1 */
            border-radius: 50px; font-weight: bold; color: white; margin-bottom: 10px; text-decoration: none; font-size: 1em;
        }
        .pay-ali { background: #00A3EE; box-shadow: 0 3px 8px rgba(0, 163, 238, 0.3); }
        .pay-wx { background: #07C160; box-shadow: 0 3px 8px rgba(7, 193, 96, 0.3); }
        
        .upload-btn-lg {
            background: linear-gradient(135deg, #FF5722 0%, #D84315 100%);
            color: white; width: 100%; padding: 15px; border-radius: 50px; /* V10.1 */
            font-size: 1.1em; font-weight: bold; display: flex; align-items: center; justify-content: center;
            margin-top: 20px; cursor: pointer; box-shadow: 0 6px 20px rgba(216, 67, 21, 0.3);
            animation: pulse 2s infinite;
        }

        /* æ”¯ä»˜åå¼•å¯¼ - æ ·å¼ä¼˜åŒ– */
        .pay-guide {
            background: #FFF8E1; border: 1px dashed #FFB74D; border-radius: 10px;
            padding: 12px 15px; margin-top: 15px; text-align: left; color: #E65100; font-size: 0.85em; /* V10.1 */
            line-height: 1.6;
        }
        .pay-guide strong { color: #BF360C; }

        /* æ‹›å‹Ÿå­¦å¾’ */
        .recruit-box { background: #FFFBF5; border: 1px dashed var(--primary); padding: 12px; text-align: center; border-radius: 10px; margin-top: 25px; /* V10.1 */ }
        .copy-btn-sm { background: var(--accent); color: white; border: none; padding: 3px 8px; border-radius: 4px; cursor: pointer; margin-left: 5px; font-size: 0.8em; }

        .copy-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; border-bottom: 1px solid #eee; padding-bottom: 6px; font-size: 0.85em; /* V10.1 */ }
        .admin-stat { background: #F5F5F5; padding: 8px; text-align: center; border-radius: 6px; margin-bottom: 12px; font-size: 0.9em; }
        #wx-guide { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 9999; text-align: center; color: #fff; display: none; padding-top: 20px; }

        /* ä»˜è´¹æŠ¥å‘Šæ ·å¼ */
        .report-section { margin-bottom: 20px; /* V10.1 */ }
        .report-title { font-size: 1.1em; font-weight: bold; color: var(--primary); margin-bottom: 10px; display: flex; align-items: center; padding-bottom: 8px; /* V10.1 */ }
        .report-title::before { content: ''; display: inline-block; width: 6px; height: 6px; background: var(--primary); border-radius: 50%; margin-right: 8px; }
        .report-content { background: #FAFAFA; padding: 15px; border-radius: 10px; color: #444; line-height: 1.7; text-align: justify; border: 1px solid #EEE; font-size: 0.95em; /* V10.1 */ }
        .report-list { padding-left: 18px; margin: 0; color: #555; }
        .report-list li { margin-bottom: 6px; /* V10.1 */ }
        .warning-box { background: #FFF5F5; border: 1px solid #FFCDD2; color: #D32F2F; padding: 12px; border-radius: 10px; display: flex; align-items: flex-start; font-size: 0.9em; /* V10.1 */ }
        .warning-box::before { content: 'âš ï¸'; margin-right: 8px; font-size: 1.1em; }
        
        .dim-detail-box { margin-bottom: 12px; /* V10.1 */ }
        .dim-header { display: flex; justify-content: space-between; font-weight: bold; margin-bottom: 4px; color: #555; font-size: 0.85em; }
        .dim-bar-bg { height: 5px; background: #eee; border-radius: 3px; overflow: hidden; }
        .dim-bar-val { height: 100%; background: var(--primary); border-radius: 3px; }
        .dim-desc { font-size: 0.85em; color: #666; margin-top: 4px; line-height: 1.4; text-align: justify; }
        .psych-box { background: #FDF8F2; padding: 12px; border-radius: 8px; color: #5D4037; font-size: 0.9em; line-height: 1.7; text-align: justify; border-left: 3px solid var(--primary); /* V10.1 */ }
        .advice-card-item { background: #FAFAFA; padding: 12px; border-radius: 8px; margin-bottom: 8px; border: 1px solid #eee; /* V10.1 */ }
        .advice-title { font-weight: bold; color: #333; margin-bottom: 4px; font-size: 0.95em; }
        .advice-content { font-size: 0.9em; color: #666; line-height: 1.5; }
        
        /* V10.1 æ–°å¢æç¤ºæ¡†æ ·å¼ */
        .alert { padding: 12px; border-radius: 8px; margin-bottom: 15px; font-size: 0.9em; display: flex; align-items: center; }
        .alert-success { background: #F6FFED; border: 1px solid #B7EB8F; color: #389E0D; }
        .alert-icon { margin-right: 8px; font-size: 1.2em; }
    </style>
</head>
<body>

<div id="wx-guide" onclick="this.style.display='none'">
    <div style="font-size: 40px; position: absolute; top: 10px; right: 20px;">â†—</div>
    <div style="margin-top: 80px; font-size: 18px; font-weight: bold; line-height: 1.8;">
        <p>âš ï¸ å¾®ä¿¡å†…æ— æ³•ç›´æ¥æ”¯ä»˜</p>
        <p>è¯·ç‚¹å‡»å³ä¸Šè§’ <span style="font-size:24px">Â·Â·Â·</span></p>
        <p>é€‰æ‹© <span style="color:#FF9800">åœ¨æµè§ˆå™¨æ‰“å¼€</span></p>
    </div>
</div>

<div class="container">

    <div id="homePage" class="card">
        <div class="header">
            <h1>â˜• å¹´ä¸Šå¹´ä¸‹æ‹çˆ±å€¾å‘æµ‹è¯•</h1>
            <p>åŸºäºè£æ ¼å¿ƒç†å­¦çš„å…³ç³»è§’è‰²åˆ†æ</p>
            <span class="badge">ç´¯è®¡æµ‹è¯• 32,491 äºº</span>
        </div>

        <div class="grid-box">
            <div class="grid-item">
                <span class="grid-icon">ğŸ‘‘</span>
                <div class="grid-text">ä¸»å¯¼ vs è¿½éš</div>
            </div>
            <div class="grid-item">
                <span class="grid-icon">ğŸ›¡ï¸</span>
                <div class="grid-text">ç‹¬ç«‹ vs ä¾èµ–</div>
            </div>
            <div class="grid-item">
                <span class="grid-icon">ğŸ•°ï¸</span>
                <div class="grid-text">ç¨³å®š vs æ¢ç´¢</div>
            </div>
            <div class="grid-item">
                <span class="grid-icon">ğŸ“œ</span>
                <div class="grid-text">åŠ¡å® vs ç†æƒ³</div>
            </div>
        </div>

        <div class="feature-list">
            <div class="feature-item"><span class="check">âœ“</span> 40é“ä¸“ä¸šå¿ƒç†é‡è¡¨è¯„ä¼°</div>
            <div class="feature-item"><span class="check">âœ“</span> 4å¤§æ ¸å¿ƒç»´åº¦é›·è¾¾å›¾åˆ†æ</div>
            <div class="feature-item"><span class="check">âœ“</span> <span style="color:#D55D30; font-weight:bold;">è¯¦ç»†æ·±åº¦æŠ¥å‘Š+è¡ŒåŠ¨æŒ‡å— (Â¥2.99è§£é”)</span></div>
        </div>

        <div class="input-group">
            <input type="text" id="cardInput" placeholder="è¯·è¾“å…¥æµ‹è¯„å¡å· (ä¸åŒºåˆ†å¤§å°å†™)">
        </div>
        <button class="btn btn-primary" onclick="verifyCard()">å¼€å§‹æµ‹è¯„</button>
        <div style="text-align:center; margin-top:20px; font-size:0.85em; color:#999; cursor:pointer;" onclick="showAdmin()">ç®¡ç†å‘˜å…¥å£ â†’</div>
    </div>

    <div id="testPage" class="card hidden">
        <div style="display:flex; justify-content:space-between; font-size:0.85em; color:#999; margin-bottom:5px;">
            <span id="progressText">è¿›åº¦ 1/40</span>
            <span>å•é€‰</span>
        </div>
        <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
        <div class="question-text" id="qText">é¢˜ç›®åŠ è½½ä¸­...</div>
        <div id="optsBox"></div>
        <div class="nav-box">
            <button class="nav-btn btn-prev" id="prevBtn" onclick="prevQuestion()">ä¸Šä¸€é¢˜</button>
            <button class="nav-btn btn-next" id="nextBtn" onclick="nextQuestion()">ä¸‹ä¸€é¢˜</button>
        </div>
    </div>

    <div id="freePage" class="card hidden">
        <div class="result-banner">
            <div style="opacity:0.9; font-size:0.85em; margin-bottom:4px;">ä½ çš„åŸºç¡€å€¾å‘åŸå‹</div>
            <div class="rpi-icon" id="resIcon">ğŸ‘‘</div>
            <div class="rpi-name" id="resName">åˆ†æä¸­...</div>
        </div>

        <div class="chart-box">
            <canvas id="radarChart"></canvas>
        </div>

        <div class="score-grid" id="scoreGrid"></div>

        <div class="free-section">
            <div class="section-title">ğŸ§© 16ç§è§’è‰²åŸå‹ä¸€è§ˆ</div>
            <div id="allTypesGrid" class="all-types-grid"></div>
        </div>

        <div class="free-section">
            <div class="section-title">ğŸ” æ€§æ ¼è¯¦ç»†ç”»åƒ</div>
            <div class="tag-cloud" id="resTags"></div>
            <div class="long-text-analysis" id="resFreeDesc"></div>
        </div>

        <div class="free-section">
            <div class="section-title">ğŸ’¡ æ‹çˆ±ä¼˜åŠ¿è§£æ</div>
            <div class="text-block" id="resAdvantage"></div>
        </div>

        <div class="free-section">
            <div class="section-title">âš ï¸ æ½œåœ¨é›·åŒºé¢„è­¦</div>
            <div class="text-block" id="resRisk" style="color:#D55D30; background:#FFF5F5;"></div>
        </div>

        <div class="locked-section" onclick="document.querySelector('.upload-btn-lg').click()">
            <div class="blur-content">
                <p>è¿™é‡Œæ˜¯æ·±åº¦æŠ¥å‘Šçš„æ ¸å¿ƒå†…å®¹ï¼ŒåŒ…å«30å¤©å…³ç³»ä¼˜åŒ–è®¡åˆ’ã€ä¸“å±æ²Ÿé€šè¯æœ¯ä»¥åŠé¿å‘æŒ‡å—ã€‚è§£é”åï¼Œä½ å°†è·å¾—ä¸€ä»½ä¸ºä½ é‡èº«å®šåˆ¶çš„å…³ç³»è¯´æ˜ä¹¦ã€‚</p>
                <p>... (æ­¤å¤„çœç•¥ 2000 å­—æ·±åº¦åˆ†æ) ...</p>
                <p>... (æ­¤å¤„çœç•¥ 30 å¤©è¡ŒåŠ¨æŒ‡å—) ...</p>
                <p>... (æ­¤å¤„çœç•¥ 4 å¤§ç»´åº¦æ·±åº¦è§£ç ) ...</p>
            </div>
            <div class="lock-overlay">
                <div class="lock-icon">ğŸ”’</div>
                <div class="lock-text">è§£é”æŸ¥çœ‹å®Œæ•´æ·±åº¦æŠ¥å‘Š + è¡ŒåŠ¨æŒ‡å—</div>
                <button class="unlock-btn-red">ç«‹å³è§£é” (ä»…éœ€ Â¥2.99)</button>
            </div>
        </div>

        <div class="unlock-box">
            <div class="price">Â¥2.99 <s>Â¥29.9</s></div>
            
            <a href="https://qr.alipay.com/tsx15981nt9c4aydmvo2h3d" class="pay-btn pay-ali">âš¡ æ”¯ä»˜å®å¿«æ·æ”¯ä»˜</a>
            <a href="javascript:void(0);" onclick="alert('è¯·ä½¿ç”¨ä¸‹æ–¹æ‰«ç æˆ–è½¬è´¦')" class="pay-btn pay-wx">âš¡ å¾®ä¿¡å¿«æ·æ”¯ä»˜</a>
            
            <div style="margin:15px 0; color:#999; font-size:0.85em;">- æˆ–æ‰«ç /è½¬è´¦ -</div>
            <div style="display:flex; justify-content:center; gap:12px; margin-bottom:15px;">
                <img src="wechat_qrcode.jpg" style="width:100px; border-radius:8px; border:1px solid #eee;">
                <img src="alipay_qrcode.png" style="width:100px; border-radius:8px; border:1px solid #eee;">
            </div>
            
            <div style="background:white; padding:12px; border-radius:10px; text-align:left; font-size:0.85em; border:1px solid #eee;">
                <div class="copy-row" style="border:none; margin:0; padding:4px 0;">
                    <span>å¾®ä¿¡: <strong style="user-select:all;">jsh9109</strong></span> 
                    <span style="color:#A07F56; cursor:pointer; font-weight:bold;" onclick="copyTxt('jsh9109')">å¤åˆ¶</span>
                </div>
                <div class="copy-row" style="border:none; margin:0; padding:4px 0;">
                    <span>æ”¯ä»˜å®: <strong style="user-select:all;">313360631@qq.com</strong></span> 
                    <span style="color:#A07F56; cursor:pointer; font-weight:bold;" onclick="copyTxt('313360631@qq.com')">å¤åˆ¶</span>
                </div>
            </div>

            <label for="upload" class="upload-btn-lg">ğŸ“¸ ä¸Šä¼ æˆªå›¾ï¼Œç«‹å³æŸ¥çœ‹æŠ¥å‘Š</label>
            <input type="file" id="upload" accept="image/*" style="display:none;" onchange="handleUpload(event)">

            <div class="pay-guide">
                <div style="font-weight:bold; margin-bottom:5px;">ğŸ’¡ ä»˜æ¬¾åå¦‚ä½•è·å–æŠ¥å‘Šï¼Ÿ</div>
                1. æˆªå›¾ä¿å­˜æ‚¨çš„æ”¯ä»˜å‡­è¯<br>
                2. ç‚¹å‡»ä¸Šæ–¹çº¢è‰²â€œ<strong>ä¸Šä¼ æˆªå›¾</strong>â€æŒ‰é’®<br>
                3. ç³»ç»Ÿæ ¸éªŒåè‡ªåŠ¨è·³è½¬æ˜¾ç¤ºå®Œæ•´æŠ¥å‘Š
            </div>
        </div>

        <div class="recruit-box">
            <div style="font-weight:bold; color:#A07F56;">ğŸ“¢ æ‹›å¿ƒç†æµ‹è¯•é¡¹ç›®å­¦å¾’</div>
            <div style="font-size:0.8em; color:#666; margin:6px 0;">é¡¹ç›®å®æ“ Â· æµé‡å˜ç° Â· é•¿æœŸå¸¦æ•™</div>
            <div style="background:white; padding:6px 12px; display:inline-block; border-radius:20px; font-size:0.9em; border:1px solid #E2C08D;">
                HCH91178 <button class="copy-btn-sm" onclick="copyWx()">å¤åˆ¶</button>
            </div>
        </div>
    </div>

    <div id="fullPage" class="card hidden">
        <div class="alert alert-success">
            <span class="alert-icon">âœ…</span>
            <span><strong>è§£é”æˆåŠŸï¼</strong> ä»¥ä¸‹æ˜¯æ‚¨çš„å®Œæ•´æ·±åº¦è¯„ä¼°æŠ¥å‘Šã€‚</span>
        </div>

        <div class="result-banner" style="margin-bottom:20px;">
            <h2>ğŸ“ æ·±åº¦è¯„ä¼°æŠ¥å‘Š</h2>
            <div style="font-size:0.85em; opacity:0.9;">ä½ çš„å…³ç³»è§’è‰²å…¨è§£æ</div>
        </div>

        <div class="chart-box">
            <canvas id="fullRadarChart"></canvas>
        </div>

        <div class="report-section">
            <div class="report-title">ğŸ“Š å››ç»´æ€§æ ¼æ·±åº¦è§£ç </div>
            <div id="dimensionAnalysisContent"></div>
        </div>

        <div class="report-section">
            <div class="report-title">ğŸ§  æ½œæ„è¯†ä¸ä¾æ‹éœ€æ±‚</div>
            <div id="subconsciousContent" class="psych-box"></div>
        </div>

        <div class="report-section">
            <div class="report-title">ğŸ’¡ å…³ç³»ä¸­çš„ç›²ç‚¹ä¸é£é™©</div>
            <div id="fullAnalysis" class="report-content"></div>
        </div>

        <div class="report-section">
            <div class="report-title">ğŸ“… 30å¤©å…³ç³»ä¼˜åŒ–å®æ“</div>
            <div class="report-content" style="background:#FDF8F2;">
                <ul id="actionPlan" class="report-list"></ul>
            </div>
        </div>
        
        <div class="report-section">
            <div class="report-title">ğŸ’¬ å…³é”®æ—¶åˆ»æ²Ÿé€šè¯æœ¯</div>
            <div id="communicationTips"></div>
        </div>

        <div class="report-section">
            <div class="report-title">âš ï¸ ä¸“å±é¿å‘æŒ‡å—</div>
            <div id="warningText" class="warning-box"></div>
        </div>

        <div class="recruit-box">
            <div style="font-weight:bold; color:#A07F56;">ğŸ“¢ æ‹›å¿ƒç†æµ‹è¯•é¡¹ç›®å­¦å¾’</div>
            <div style="background:white; padding:6px 12px; display:inline-block; border-radius:20px; margin-top:8px; border:1px solid #E2C08D;">
                HCH91178 <button class="copy-btn-sm" onclick="copyWx()">å¤åˆ¶</button>
            </div>
        </div>
    </div>

    <div id="adminPage" class="card hidden">
        <h3 style="text-align:center; color:#A07F56;">åå°ç®¡ç†</h3>
        <div id="adminLogin">
            <input type="password" id="admPwd" placeholder="å¯†ç " style="width:100%; padding:12px; margin:15px 0; border:1px solid #ddd; border-radius:8px;">
            <button class="btn btn-primary" onclick="login()">ç™»å½•</button>
        </div>
        <div id="adminMain" class="hidden">
            <div class="admin-stat">å¯ç”¨å¡å¯†ï¼š<span id="validNum" style="font-weight:bold; color:green;">0</span></div>
            <div style="margin:15px 0; display:flex; gap:8px;">
                <input type="number" id="genCount" value="10" style="width:70px; padding:8px; border:1px solid #ddd; border-radius:5px;">
                <button class="copy-btn-sm" onclick="genCards()" style="padding:8px 15px; font-size:0.9em;">ç”Ÿæˆ(NSå¼€å¤´)</button>
            </div>
            <div class="card-list" id="cardList" style="max-height:200px; overflow-y:auto; border:1px solid #eee; padding:10px; margin-bottom:15px; font-size:0.9em;"></div>
            <div style="display:flex; gap:8px;">
                <button class="copy-btn-sm" style="background:#2E7D32; padding:8px; flex:1; font-size:0.9em;" onclick="exportNew()">å¯¼å‡ºæœ¬æ¬¡</button>
                <button class="copy-btn-sm" style="background:#00b894; padding:8px; flex:1; font-size:0.9em;" onclick="exportAll()">å¯¼å‡ºå…¨éƒ¨</button>
            </div>
            <button class="btn btn-secondary" onclick="location.reload()" style="margin-top:20px;">é€€å‡º</button>
        </div>
    </div>

</div>

<script>
const CONFIG = {
    MASTER_CODE: "GEMINI-MASTER",
    ADMIN_PWD: "lss900201",
    SERVER_KEY: "SCT303445TGU9j8Q5VLg6rT7eryLe8L41v"
};

const questions = [
    {t:'å€¾å‘ä¸»åŠ¨è§„åˆ’çº¦ä¼šå’Œæ—…è¡Œ', d:0}, {t:'æ›´å–œæ¬¢å¯¹æ–¹å¬ä»æˆ‘çš„æ„è§', d:0}, {t:'ä¸ºäº†å’Œè°æ„¿æ„æ”¾å¼ƒè§‚ç‚¹', d:0, r:1}, {t:'ç»å¸¸å……å½“å†³ç­–è€…', d:0}, {t:'å–œæ¬¢æŒæ§å…±åŒè´¢åŠ¡', d:0},
    {t:'æ›´å–œæ¬¢è¢«ç…§é¡¾å’Œå®‰æ’', d:0, r:1}, {t:'æ„¿ä¸ºä¼´ä¾£å¿«ä¹æ‰¿æ‹…è´£ä»»', d:0}, {t:'å¾ˆéš¾å¯¹ä¼´ä¾£è¯´ä¸', d:0, r:1}, {t:'å–œæ¬¢æœ‰äººæ›¿æˆ‘æ‹¿ä¸»æ„', d:0, r:1}, {t:'è®¤ä¸ºå…³ç³»åº”æœ‰æ˜ç¡®é¢†å¯¼', d:0},
    {t:'é•¿æ—¶é—´ç‹¬å¤„ä¸æ„Ÿåˆ°ç„¦è™‘', d:1}, {t:'æœ‰ç‹¬ç«‹æœ‹å‹åœˆä¸éœ€è¦ä¼´ä¾£', d:1}, {t:'éœ€é¢‘ç¹ç¡®è®¤çˆ±å’Œå¿ è¯š', d:1, r:1}, {t:'ä¸ç§’å›ä¿¡æ¯ä¼šä¸å®‰', d:1, r:1}, {t:'é€šå¸¸è‡ªå·±è§£å†³é—®é¢˜', d:1},
    {t:'æ²¡ä¼´ä¾£å¾ˆéš¾åšé‡è¦äº‹', d:1, r:1}, {t:'å¸Œæœ›ä¼´ä¾£å®Œå…¨å¼€æ”¾ç¤¾äº¤', d:1, r:1}, {t:'è½»æ¾å¤„ç†ä¼´ä¾£ä¸åœ¨èº«è¾¹', d:1}, {t:'å¸¸æ‹…å¿ƒä¼´ä¾£ç¦»å¼€', d:1, r:1}, {t:'ä¿æŒå¿ƒç†è·ç¦»', d:1},
    {t:'è¿½æ±‚ç¨³å®šå¯é¢„æµ‹', d:2}, {t:'å–œæ¬¢å°è¯•å†’é™©æ´»åŠ¨', d:2, r:1}, {t:'çœ‹é‡æ½œåŠ›è€Œéç»éªŒ', d:2, r:1}, {t:'åšæŒå›ºå®šä¹ æƒ¯', d:2}, {t:'å–œæ¬¢åˆ†äº«ç»éªŒç»™ä¼´ä¾£', d:2},
    {t:'æ„¿æ”¹å˜è‡ªå·±é€‚åº”ä¼´ä¾£', d:2, r:1}, {t:'å–œæ¬¢å……æ»¡æƒŠå–œ', d:2, r:1}, {t:'å–œæ¬¢æˆç†Ÿæœ‰é˜…å†çš„', d:2}, {t:'ä¸å–œæ¬¢å‘å±•å¤ªå¿«', d:2}, {t:'çœ‹é‡æ´»åŠ›æ¿€æƒ…', d:2, r:1},
    {t:'è€ƒè™‘ç»æµå’ŒèŒä¸šè§„åˆ’', d:3}, {t:'ç›¸ä¿¡æ„Ÿè§‰è€Œéæ•°æ®', d:3, r:1}, {t:'æœ‰è¯¦ç»†æœªæ¥è®¡åˆ’', d:3}, {t:'çœ‹é‡æƒ…æ„Ÿè¿æ¥', d:3, r:1}, {t:'å¸¸å¹»æƒ³å®Œç¾çˆ±æƒ…', d:3, r:1},
    {t:'çœ‹é‡å¯¹æ–¹æä¾›ç¨³å®šç”Ÿæ´»', d:3}, {t:'è„šè¸å®åœ°è§£å†³é—®é¢˜', d:3}, {t:'æ‰¿æ‹…åŠ¡å®è§’è‰²(è®°è´¦ç­‰)', d:3}, {t:'å¾ˆå°‘è€ƒè™‘é•¿æœŸ', d:3, r:1}, {t:'æ„¿ä¸ºçˆ±æ”¾å¼ƒç‰©è´¨', d:3, r:1}
];

const types = {
    'MIPT': {n:'å…¨èƒ½å®ˆæŠ¤è€…', i:'ğŸ‘‘', d:'å…³ç³»ä¸­çš„å®šæµ·ç¥é’ˆã€‚', tag:['ä¸»å¯¼å¼º','æåº¦ç‹¬ç«‹','åŠ¡å®æ´¾'], freeDesc:'ä½ åœ¨å…³ç³»ä¸­è¡¨ç°å‡ºæå¼ºçš„è´£ä»»æ„Ÿå’ŒæŒæ§åŠ›ã€‚ä½ ä¹ æƒ¯äºå……å½“"å¤§å®¶é•¿"çš„è§’è‰²ï¼Œä¸ºä¼´ä¾£é®é£æŒ¡é›¨ã€‚ä½ ç‹¬ç«‹è‡ªä¸»ï¼Œä¸å–œæ¬¢ç»™åˆ«äººæ·»éº»çƒ¦ï¼ŒåŒæ—¶ä¹Ÿå¸Œæœ›ç”Ÿæ´»èƒ½åœ¨ä½ çš„è§„åˆ’ä¸‹æœ‰åºè¿›è¡Œã€‚', adv:'èƒ½ç»™äºˆä¼´ä¾£æå¤§çš„å®‰å…¨æ„Ÿï¼Œç”Ÿæ´»å®‰æ’äº•äº•æœ‰æ¡ã€‚', risk:'å®¹æ˜“å› è¿‡åº¦æŒæ§è€Œè®©ä¼´ä¾£æ„Ÿåˆ°çª’æ¯ï¼Œå¿½ç•¥å¯¹æ–¹çš„æƒ…æ„Ÿéœ€æ±‚ã€‚'},
    'MIPF': {n:'ç†æƒ³å¼•è·¯äºº', i:'ğŸ› ï¸', d:'å¸¦é¢†ä¼´ä¾£å¥”èµ´ç†æƒ³ã€‚', tag:['æœ‰ä¸»è§','è¿½æ±‚æµªæ¼«','è¡ŒåŠ¨åŠ›'], freeDesc:'ä½ æ—¢æœ‰ä¸»è§åˆå……æ»¡æµªæ¼«æƒ…æ€€ã€‚ä½ ä¸æ»¡è¶³äºå¹³åº¸çš„å…³ç³»ï¼Œæ€»æ˜¯è¯•å›¾å¼•å¯¼ä¼´ä¾£ä¸€èµ·æˆé•¿ï¼Œå…±åŒè¿½æ±‚æ›´é«˜çš„ç”Ÿæ´»ç›®æ ‡ã€‚ä½ çš„ç‹¬ç«‹æ€§å¾ˆå¼ºï¼Œä½†ä¹Ÿæ¸´æœ›ç²¾ç¥ä¸Šçš„æ·±åº¦å…±é¸£ã€‚', adv:'èƒ½å°†æµªæ¼«çš„æƒ³æ³•è½¬åŒ–ä¸ºç°å®ï¼Œå¸¦é¢†ä¼´ä¾£å…±åŒæˆé•¿ã€‚', risk:'æœ‰æ—¶è¿‡äºç†æƒ³åŒ–ï¼Œå½“ç°å®ä¸å¦‚æ„æ—¶å®¹æ˜“å¯¹ä¼´ä¾£å¤±æœ›ã€‚'},
    'MIST': {n:'ç†æ€§å¯¼å¸ˆ', i:'ğŸ§­', d:'ç¨³å®šçš„å¯¼å¸ˆå’Œå¼•é¢†è€…ã€‚', tag:['æƒ…ç»ªç¨³å®š','é€»è¾‘å¼º','å®‰å…¨æ„Ÿ'], freeDesc:'ä½ æ˜¯ç†æ™ºä¸ç¨³å®šçš„åŒ–èº«ã€‚åœ¨å…³ç³»ä¸­ï¼Œä½ ä¹ æƒ¯ç”¨é€»è¾‘è§£å†³é—®é¢˜ï¼Œä¸ºä¼´ä¾£æä¾›åˆ‡å®å¯è¡Œçš„å»ºè®®ã€‚ä½ å¾ˆå°‘æƒ…ç»ªåŒ–ï¼Œæ˜¯ä¼´ä¾£åœ¨æ··ä¹±æ—¶åˆ»æœ€å¯é çš„ä¾èµ–å¯¹è±¡ã€‚', adv:'åœ¨å±æœºæ—¶åˆ»èƒ½ä¿æŒå†·é™ï¼Œæ˜¯ä¼´ä¾£æœ€å¯é çš„ä¾èµ–ã€‚', risk:'å¯èƒ½æ˜¾å¾—è¿‡äºå†·æ¼ æˆ–è¯´æ•™ï¼Œç¼ºä¹æƒ…æ„Ÿå…±é¸£ã€‚'},
    'MISF': {n:'æ¸©æƒ…é¢†è¢–', i:'ğŸš¢', d:'æä¾›æ–¹å‘å’Œæ¸©æš–ã€‚', tag:['å¤–æŸ”å†…åˆš','åŒ…å®¹','æ–¹å‘æ„Ÿ'], freeDesc:'ä½ æ¸©æŸ”è€Œåšå®šï¼Œæ‹¥æœ‰å¼ºå¤§çš„åŒ…å®¹åŠ›ã€‚ä½ ä¸ä»…èƒ½æŠŠæ¡å…³ç³»çš„å¤§æ–¹å‘ï¼Œè¿˜èƒ½æ•é”åœ°æ„ŸçŸ¥ä¼´ä¾£çš„æƒ…ç»ªå˜åŒ–ã€‚ä½ ç”¨æ¸©æŸ”çš„æ–¹å¼ä¸»å¯¼ç€å…³ç³»ï¼Œè®©ä¼´ä¾£æ„Ÿåˆ°èˆ’é€‚ã€‚', adv:'æ—¢æœ‰ä¸»è§åˆèƒ½æä¾›æƒ…ç»ªä»·å€¼ï¼Œæ˜¯å®Œç¾çš„ä¼´ä¾£äººé€‰ã€‚', risk:'å®¹æ˜“ä¸ºäº†ç…§é¡¾ä¼´ä¾£æƒ…ç»ªè€Œå§”å±ˆè‡ªå·±ï¼Œç§¯å‹ä¸æ»¡ã€‚'},
    'MEPT': {n:'æ´»åŠ›å¼€åˆ›è€…', i:'ğŸ’¡', d:'å……æ»¡æ´»åŠ›çš„æ–°é²œæ„Ÿã€‚', tag:['çˆ±æŠ˜è…¾','æ–°é²œæ„Ÿ','ä¸»å¯¼'], freeDesc:'ä½ æ˜¯å¤©ç”Ÿçš„å†’é™©å®¶å’Œé¢†å¯¼è€…ã€‚ä½ è®¨åŒä¸€æˆä¸å˜ï¼Œæ€»æ˜¯å¸¦ç€ä¼´ä¾£å°è¯•æ–°é²œäº‹ç‰©ã€‚ä½ çš„èƒ½é‡æé«˜ï¼Œåœ¨å…³ç³»ä¸­å æ®ä¸»åŠ¨ï¼Œå¸¦ç€ä¼´ä¾£ä¸€èµ·æ¢ç´¢ä¸–ç•Œçš„è¾¹ç•Œã€‚', adv:'ç”Ÿæ´»æ°¸è¿œä¸ä¼šæ— èŠï¼Œèƒ½å¸¦ç»™ä¼´ä¾£æ— é™çš„æ–°å¥‡ä½“éªŒã€‚', risk:'ä¸‰åˆ†é’Ÿçƒ­åº¦ï¼Œå¯èƒ½è®©è¿½æ±‚ç¨³å®šçš„ä¼´ä¾£æ„Ÿåˆ°ä¸å®‰ã€‚'},
    'MEPF': {n:'æ¿€æƒ…å†’é™©å®¶', i:'âš¡', d:'è¡ŒåŠ¨æ´¾çš„çƒ­æƒ…å¹´ä¸Šã€‚', tag:['è¡ŒåŠ¨æ´¾','æ¿€æƒ…','é«˜èƒ½é‡'], freeDesc:'ä½ çš„çˆ±çƒ­çƒˆè€Œç›´æ¥ã€‚ä½ æ˜¯å…¸å‹çš„è¡ŒåŠ¨æ´¾ï¼Œæƒ³åˆ°ä»€ä¹ˆå°±ä¼šç«‹åˆ»å¸¦ä¼´ä¾£å»å®æ–½ã€‚ä½ çš„çƒ­æƒ…æå…·æ„ŸæŸ“åŠ›ï¼Œèƒ½ç¬é—´ç‚¹ç‡ƒå…³ç³»ä¸­çš„ç«èŠ±ã€‚', adv:'æå…·æ„ŸæŸ“åŠ›ï¼Œèƒ½ç‚¹ç‡ƒä¼´ä¾£çš„çƒ­æƒ…ã€‚', risk:'å†²åŠ¨è¡Œäº‹ï¼Œå¯èƒ½åœ¨è´¢åŠ¡æˆ–è§„åˆ’ä¸Šç¼ºä¹é•¿è¿œè€ƒè™‘ã€‚'},
    'MEST': {n:'æŒæ§å‹ç®¡å®¶', i:'ğŸ”—', d:'æŒæ§ç»†èŠ‚ï¼Œæ¸´æœ›ä¾èµ–ã€‚', tag:['ç»†èŠ‚æ§','æ§åˆ¶æ¬²','æŠ¤çŸ­'], freeDesc:'ä½ å¯¹ç”Ÿæ´»çš„æŒæ§ç»†è‡´å…¥å¾®ã€‚ä½ ä¸ä»…è§„åˆ’å¤§æ–¹å‘ï¼Œè¿ç”Ÿæ´»ç»†èŠ‚ä¹Ÿå¸Œæœ›ä¸€æ‰‹åŒ…åŠã€‚ä½ äº«å—ç…§é¡¾ä¼´ä¾£çš„æ„Ÿè§‰ï¼ŒåŒæ—¶ä¹Ÿæ¸´æœ›ä¼´ä¾£å¯¹ä½ äº§ç”Ÿæ·±æ·±çš„æƒ…æ„Ÿä¾èµ–ã€‚', adv:'å¯¹ä¼´ä¾£çš„ç…§é¡¾æ— å¾®ä¸è‡³ï¼Œç”Ÿæ´»ç»†èŠ‚æ»¡åˆ†ã€‚', risk:'å®¹æ˜“å˜å¾—å” å¨å’Œæ§åˆ¶ï¼Œå¼•å‘ä¼´ä¾£çš„åæŠ—ã€‚'},
    'MESF': {n:'æµªæ¼«ä¸»å®°è€…', i:'ğŸ”¥', d:'ç”¨æƒ…æ„Ÿæ”»åŠ¿å¾æœä¼´ä¾£ã€‚', tag:['æ‹çˆ±è„‘','é«˜æµ“åº¦','ä¸»å¯¼'], freeDesc:'ä½ æ˜¯çˆ±æƒ…é‡Œçš„ç»å¯¹ä¸»è§’ã€‚ä½ æ“…é•¿åˆ¶é€ æµªæ¼«å’ŒæƒŠå–œï¼Œç”¨é«˜æµ“åº¦çš„æƒ…æ„ŸåŒ…å›´ä¼´ä¾£ã€‚ä½ ä¸»å¯¼ç€å…³ç³»çš„èŠ‚å¥ï¼Œæ¸´æœ›ä¸€åœºè½°è½°çƒˆçƒˆçš„çˆ±æƒ…ã€‚', adv:'èƒ½æä¾›æè‡´çš„æµªæ¼«ä½“éªŒï¼Œè®©ä¼´ä¾£æ„Ÿåˆ°è¢«æ·±æ·±çˆ±ç€ã€‚', risk:'æƒ…ç»ªæ³¢åŠ¨å¤§ï¼Œå¯¹ä¼´ä¾£çš„åé¦ˆè¦æ±‚æé«˜ï¼Œå®¹æ˜“æ‚£å¾—æ‚£å¤±ã€‚'},
    'DIPT': {n:'ç‹¬ç«‹åä½œè€…', i:'âš–ï¸', d:'è¿½æ±‚å¹³ç­‰å°Šé‡çš„ä¼™ä¼´ã€‚', tag:['ç•Œé™æ„Ÿ','å¹³ç­‰','ç†æ™º'], freeDesc:'ä½ è™½ç„¶ä¸è¿½æ±‚ä¸»å¯¼æƒï¼Œä½†å†…å¿ƒéå¸¸ç‹¬ç«‹ã€‚ä½ å°†ä¼´ä¾£è§†ä¸ºå¹³ç­‰çš„åˆä½œä¼™ä¼´ï¼Œä¸ä¾èµ–ä¹Ÿä¸æ§åˆ¶ã€‚ä½ è¿½æ±‚çš„æ˜¯ä¸€ç§ç›¸æ•¬å¦‚å®¾ã€å„è‡ªç²¾å½©çš„æˆç†Ÿå…³ç³»ã€‚', adv:'ä¸ç»™ä¼´ä¾£æ·»éº»çƒ¦ï¼Œèƒ½æ„å»ºå¥åº·å¹³ç­‰çš„é•¿æœŸå…³ç³»ã€‚', risk:'å¯èƒ½æ˜¾å¾—è¿‡äºå®¢æ°”å’Œç–ç¦»ï¼Œç¼ºä¹äº²å¯†çš„ä¾èµ–æ„Ÿã€‚'},
    'DIPF': {n:'è‡ªç”±çµé­‚', i:'ğŸ“ˆ', d:'é…åˆåº¦é«˜ï¼Œå‘å¾€è‡ªç”±ã€‚', tag:['éšæ€§','é…åˆ','ç²¾ç¥è‡ªç”±'], freeDesc:'ä½ éšæ€§è€Œæ´’è„±ï¼Œä¸æ„¿è¢«ä¸–ä¿—çš„æ¡æ¡æ¡†æ¡†æŸç¼šã€‚åœ¨å…³ç³»ä¸­ï¼Œä½ æ„¿æ„é…åˆä¼´ä¾£çš„å†³å®šï¼Œä½†å‰ææ˜¯ä¸èƒ½ç‰ºç‰²ä½ çš„ç²¾ç¥è‡ªç”±å’Œä¸ªäººç©ºé—´ã€‚', adv:'ç›¸å¤„è½»æ¾æ„‰å¿«ï¼Œèƒ½ç»™äºˆä¼´ä¾£å……åˆ†çš„ç©ºé—´ã€‚', risk:'åœ¨å…³ç³»é‡åˆ°å›°éš¾æ—¶ï¼Œå¯èƒ½å€¾å‘äºé€ƒé¿è€Œéè§£å†³ã€‚'},
    'DIST': {n:'æ¸©é¡ºé™ªä¼´è€…', i:'ğŸ¦¢', d:'åšå®çš„åæ–¹æ”¯æŒè€…ã€‚', tag:['é¡¾å®¶','å¬è¯','å®‰ç¨³'], freeDesc:'ä½ æ˜¯æœ€å¿ è¯šçš„ä¼´ä¾£ã€‚ä½ æ¸´æœ›å®‰ç¨³çš„ç”Ÿæ´»ï¼Œæ„¿æ„å¬ä»ä¼´ä¾£çš„å®‰æ’ã€‚ä½ çš„æ€§æ ¼æ¸©å’Œï¼Œä¸å–œäº‰æ‰§ï¼Œè‡´åŠ›äºä¸ºä¼´ä¾£è¥é€ ä¸€ä¸ªæ¸©é¦¨çš„å¤§åæ–¹ã€‚', adv:'å¿ è¯šåº¦æé«˜ï¼Œèƒ½æä¾›ç¨³å®šçš„åæ–¹æ”¯æŒã€‚', risk:'å®¹æ˜“åœ¨å…³ç³»ä¸­å¤±å»è‡ªæˆ‘ï¼Œè¿‡åº¦ä¾èµ–ä¼´ä¾£çš„å†³ç­–ã€‚'},
    'DISF': {n:'æƒ…æ„Ÿä¾èµ–è€…', i:'ğŸ§¸', d:'æ¸´æœ›è¢«çˆ±å’Œç…§é¡¾ã€‚', tag:['ç²˜äºº','ä»˜å‡ºå‹','æ±‚å…³æ³¨'], freeDesc:'ä½ æ˜¯ä¸€åªç²˜äººçš„å°çŒ«ã€‚åœ¨å…³ç³»ä¸­ï¼Œä½ æåº¦æ¸´æœ›è¢«å…³æ³¨å’Œå‘µæŠ¤ã€‚ä½ æ„¿æ„ä¸ºçˆ±ä»˜å‡ºä¸€åˆ‡ï¼Œä½ çš„å¿«ä¹å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºä¼´ä¾£çš„æ€åº¦ã€‚', adv:'èƒ½æä¾›æé«˜çš„æƒ…ç»ªä»·å€¼ï¼Œè®©ä¼´ä¾£æ„Ÿåˆ°è¢«éœ€è¦ã€‚', risk:'ç¼ºä¹ç‹¬ç«‹æ€§ï¼Œä¸€æ—¦ä¼´ä¾£ç¦»å¼€å¯èƒ½ä¼šå´©æºƒã€‚'},
    'DEPT': {n:'ç©ä¼´å‹æ‹äºº', i:'ğŸ—ºï¸', d:'æœ‰è¶£éšå’Œçš„ç©ä¼´ã€‚', tag:['æœ‰è¶£','éšå’Œ','æ— å‹åŠ›'], freeDesc:'ä½ å°±åƒä¸€ä¸ªé•¿ä¸å¤§çš„å­©å­ï¼Œå……æ»¡ç«¥å¿ƒã€‚ä½ éšå’Œå¥½ç›¸å¤„ï¼Œä¸äº‰å¤ºæƒåŠ›ï¼Œåªæƒ³å’Œä¼´ä¾£ä¸€èµ·å¼€å¿ƒåœ°ç©è€ã€‚ä½ æ˜¯ä¼´ä¾£ç¼“è§£å‹åŠ›çš„æœ€ä½³è‰¯è¯ã€‚', adv:'èƒ½å¿«é€Ÿé€‚åº”å„ç§ç¯å¢ƒï¼Œæ˜¯æä½³çš„æ—…è¡Œå’Œç”Ÿæ´»ä¼™ä¼´ã€‚', risk:'ç¼ºä¹è´£ä»»æ„Ÿï¼Œåœ¨é¢ä¸´é‡å¤§å†³ç­–æ—¶å¯èƒ½æ˜¾å¾—é€ƒé¿ã€‚'},
    'DEPF': {n:'å¥½å¥‡å®å®', i:'ğŸ”', d:'ç†æ€§é©±åŠ¨çš„å¥½å¥‡è¿½éšè€…ã€‚', tag:['å¥½å¥‡å¿ƒ','è·Ÿéš','å¯å¡‘æ€§'], freeDesc:'ä½ å¯¹ä¸–ç•Œå……æ»¡å¥½å¥‡ï¼Œå–œæ¬¢è·Ÿéšå¼ºè€…çš„æ­¥ä¼ã€‚ä½ æ„¿æ„åœ¨ä¼´ä¾£çš„å¸¦é¢†ä¸‹æ¢ç´¢æœªçŸ¥é¢†åŸŸï¼Œä½ çš„å¯å¡‘æ€§æå¼ºï¼Œèƒ½é€‚åº”å¤šç§å…³ç³»æ¨¡å¼ã€‚', adv:'å­¦ä¹ èƒ½åŠ›å¼ºï¼Œèƒ½ä¸ä¼´ä¾£å…±åŒæ¢ç´¢æ–°é¢†åŸŸã€‚', risk:'å®¹æ˜“è¢«å¤–ç•Œè¯±æƒ‘å¸å¼•ï¼Œç«‹åœºä¸å¤Ÿåšå®šã€‚'},
    'DEST': {n:'ä¹–å·§å­¦ç”Ÿ', i:'ğŸ¤', d:'å¬è¯ä¸”ç¨³å®šã€‚', tag:['æ‰§è¡ŒåŠ›','ä¹–å·§','çœå¿ƒ'], freeDesc:'ä½ æ˜¯æœ€è®©ä¼´ä¾£çœå¿ƒçš„å­˜åœ¨ã€‚ä½ å¾ªè§„è¹ˆçŸ©ï¼Œå–œæ¬¢è¢«å®‰æ’å¾—äº•äº•æœ‰æ¡çš„ç”Ÿæ´»ã€‚åªè¦ä¼´ä¾£ç»™å‡ºæ˜ç¡®çš„æŒ‡ä»¤ï¼Œä½ å°±èƒ½å®Œç¾æ‰§è¡Œï¼Œä»ä¸æƒ¹éº»çƒ¦ã€‚', adv:'æ‰§è¡ŒåŠ›å¼ºï¼Œåªè¦ä¼´ä¾£ç»™å‡ºæŒ‡ä»¤å°±èƒ½å®Œç¾å®Œæˆã€‚', risk:'ç¼ºä¹ä¸»è§ï¼Œé‡åˆ°çªå‘æƒ…å†µå¯èƒ½ä¸çŸ¥æ‰€æªã€‚'},
    'DESF': {n:'æµªæ¼«è¿½éšè€…', i:'âœ¨', d:'è§†çˆ±æƒ…ä¸ºå…¨éƒ¨ã€‚', tag:['æµªæ¼«','æ·±æƒ…','è·Ÿéš'], freeDesc:'ä½ æ˜¯ä¸ºçˆ±è€Œç”Ÿçš„ã€‚ä½ å¯¹çˆ±æƒ…å……æ»¡ç¾å¥½çš„å¹»æƒ³ï¼Œæ„¿æ„è·Ÿéšä¼´ä¾£åˆ°å¤©æ¶¯æµ·è§’ã€‚ä½ çš„çˆ±çº¯ç²¹è€Œçƒ­çƒˆï¼Œèƒ½ç»™ä¼´ä¾£å¸¦æ¥æè‡´çš„æƒ…æ„Ÿä½“éªŒã€‚', adv:'å…¨å¿ƒå…¨æ„æŠ•å…¥ï¼Œèƒ½ç»™ä¼´ä¾£æè‡´çš„è¢«çˆ±ä½“éªŒã€‚', risk:'å®¹æ˜“é™·å…¥è‡ªæˆ‘æ„ŸåŠ¨çš„ä»˜å‡ºï¼Œå¿½ç•¥ç°å®é—®é¢˜ã€‚'}
};

let state = { idx:0, ans:[], code:'' };
let batchCards = [];

window.onload = function() {
    try {
        let oldCards = JSON.parse(localStorage.getItem('social_cards')||'[]');
        let currentCards = JSON.parse(localStorage.getItem('ageCards')||'[]');
        let merged = [...currentCards];
        oldCards.forEach(old => {
            if(!merged.find(c => c.code === old.code)) merged.push(old);
        });
        localStorage.setItem('ageCards', JSON.stringify(merged));
    } catch(e) {}
    
    if(navigator.userAgent.toLowerCase().includes('micromessenger')) {
        document.getElementById('wx-guide').style.display = 'block';
    }
};

function verifyCard() {
    let inp = document.getElementById('cardInput').value.trim().toUpperCase();
    if(!inp) return alert('è¯·è¾“å…¥å¡å·');
    if(inp===CONFIG.MASTER_CODE) return start();
    
    if(!/^(TF|NS|SH)-[A-Z0-9]{4}-[A-Z0-9]{4}$/.test(inp)) return alert('å¡å·æ ¼å¼é”™è¯¯');
    
    try {
        let usage = JSON.parse(localStorage.getItem('age_usage_v4')||'{}');
        let now = Date.now();
        if(usage[inp] && (now - usage[inp] > 86400000)) return alert('å¡å·å·²è¿‡æœŸ(é™24h)');
        
        usage[inp] = usage[inp] || now;
        localStorage.setItem('age_usage_v4', JSON.stringify(usage));
        
        let cards = JSON.parse(localStorage.getItem('ageCards')||'[]');
        let c = cards.find(x=>x.code===inp);
        if(c) { c.used=true; localStorage.setItem('ageCards',JSON.stringify(cards)); }
        
        start();
    } catch(e){ alert('è¯·æ¸…ç¼“å­˜é‡è¯•'); }
}

function start() {
    document.getElementById('homePage').classList.add('hidden');
    document.getElementById('testPage').classList.remove('hidden');
    renderQ();
}

function renderQ() {
    let q = questions[state.idx];
    document.getElementById('qText').innerText = `${state.idx+1}. ${q.t}`;
    document.getElementById('progressFill').style.width = ((state.idx+1)/40*100)+'%';
    document.getElementById('progressText').innerText = `è¿›åº¦ ${state.idx+1}/40`;
    document.getElementById('prevBtn').style.display = state.idx > 0 ? 'block' : 'none';
    
    let h = '';
    ['å®Œå…¨ä¸åƒ','ä¸å¤ªåƒ','ä¸ç¡®å®š','æœ‰ç‚¹åƒ','éå¸¸åƒ'].forEach((t,i)=>{
        h += `<div class="option ${state.ans[state.idx]===(i+1)?'selected':''}" onclick="sel(${i+1})">${t}</div>`;
    });
    document.getElementById('optsBox').innerHTML = h;
}

function sel(n) {
    state.ans[state.idx] = n;
    renderQ();
    setTimeout(()=>{
        if(state.idx<39) { state.idx++; renderQ(); }
        else calc();
    }, 200);
}

function prevQuestion() { if(state.idx > 0) { state.idx--; renderQ(); } }
function nextQuestion() { if(!state.ans[state.idx]) return alert('è¯·é€‰æ‹©'); if(state.idx<39) { state.idx++; renderQ(); } else calc(); }

function calc() {
    let d = [0,0,0,0];
    questions.forEach((q,i)=>{
        let v = state.ans[i]||3;
        if(q.r) v = 6-v;
        d[q.d] += v;
    });
    
    let scores = d.map(s => Math.round((s/50)*100));
    let k = (d[0]>=28?'M':'D') + (d[1]>=28?'I':'S') + (d[3]>=28?'P':'F') + (d[2]>=28?'T':'E');
    if(!types[k]) k='MIPT'; 
    
    sessionStorage.setItem('res', JSON.stringify({s:scores, k:k, raw:d}));
    showFree();
}

function showFree() {
    document.getElementById('testPage').classList.add('hidden');
    document.getElementById('freePage').classList.remove('hidden');
    let res = JSON.parse(sessionStorage.getItem('res'));
    let userKey = res.k;
    let t = types[userKey];
    
    document.getElementById('resIcon').innerText = t.i;
    document.getElementById('resName').innerText = t.n;
    document.getElementById('resTags').innerHTML = t.tag.map(x=>`<span class="tag">${x}</span>`).join('');
    document.getElementById('resFreeDesc').innerText = t.freeDesc;
    document.getElementById('resAdvantage').innerText = t.adv;
    document.getElementById('resRisk').innerText = t.risk;
    
    let dNames = ['ä¸»å¯¼åŠ›','ç‹¬ç«‹æ€§','ç¨³å®šæ€§','åŠ¡å®åº¦'];
    let dHtml = '';
    res.s.forEach((s,i)=>{
        dHtml += `<div class="score-card"><div class="score-label">${dNames[i]}</div><div class="score-val">${s}</div></div>`;
    });
    document.getElementById('scoreGrid').innerHTML = dHtml;

    let allTypesHtml = '';
    for (let key in types) {
        let type = types[key];
        let isActive = (key === userKey);
        allTypesHtml += `<div class="type-item ${isActive ? 'active' : ''}">${isActive ? '<span class="type-star">â­ï¸</span>' : ''}<span class="type-icon-sm">${type.i}</span><div>${type.n}</div></div>`;
    }
    document.getElementById('allTypesGrid').innerHTML = allTypesHtml;
    
    let chartConfig = {
        type: 'radar',
        data: {
            labels: dNames,
            datasets: [{
                data: res.s,
                backgroundColor: 'rgba(160,127,86,0.2)',
                borderColor: '#A07F56',
                pointBackgroundColor: '#A07F56',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: '#A07F56'
            }]
        },
        options: {
            maintainAspectRatio: false,
            scale: {
                ticks: { display: true, beginAtZero: true, max: 100, stepSize: 20, fontSize: 10, fontColor: '#999' },
                pointLabels: { fontSize: 12, fontColor: '#333' },
                gridLines: { color: '#eee' }
            },
            legend: { display: false },
            layout: { padding: 10 }
        }
    };

    setTimeout(()=>{
        new Chart(document.getElementById('radarChart'), chartConfig);
    }, 200);
}

function handleUpload(e) {
    if(e.target.files[0]) {
        document.querySelector('.upload-btn-lg').innerText = 'â³ æ­£åœ¨åˆ†ææ•°æ®...';
        fetch(`https://sctapi.ftqq.com/${CONFIG.SERVER_KEY}.send`, {
            method:'POST', headers:{'Content-Type':'application/json'},
            body:JSON.stringify({title:'ğŸ’°æ–°è®¢å•-å¹´ä¸Šå¹´ä¸‹-V10.1', desp:'æœ‰æ–°æˆªå›¾'})
        }).catch(()=>{});
        
        setTimeout(showFull, 1500);
    }
}

function showFull() {
    document.getElementById('freePage').classList.add('hidden');
    document.getElementById('fullPage').classList.remove('hidden');
    let res = JSON.parse(sessionStorage.getItem('res'));
    let t = types[res.k];
    
    // 1. ç»´åº¦æ·±åº¦è§£ç 
    const dims = ['ä¸»å¯¼åŠ›', 'ç‹¬ç«‹æ€§', 'ç¨³å®šæ€§', 'åŠ¡å®åº¦'];
    const dimDescs = [
        ['ä½ çš„ä¸»å¯¼æ„æ„¿è¾ƒä½ï¼Œæ›´å–œæ¬¢é…åˆã€‚è¿™è®©ä½ æˆä¸ºå¾ˆå¥½çš„åˆä½œä¼™ä¼´ï¼Œä½†ä¹Ÿå®¹æ˜“å¤±å»è‡ªæˆ‘ã€‚', 'ä½ çš„ä¸»å¯¼åŠ›é€‚ä¸­ï¼Œèƒ½å±ˆèƒ½ä¼¸ã€‚åœ¨å…³é”®æ—¶åˆ»èƒ½ç«™å‡ºæ¥ï¼Œå¹³æ—¶ä¹Ÿä¹äºå€¾å¬ã€‚', 'ä½ æœ‰æå¼ºçš„ä¸»å¯¼æ¬²å’ŒæŒæ§åŠ›ã€‚ä½ ä¹ æƒ¯ä¸ºå…³ç³»è´Ÿè´£ï¼Œä½†éœ€æ³¨æ„ä¸è¦å˜æˆç‹¬è£è€…ã€‚'],
        ['ä½ éå¸¸æ¸´æœ›é™ªä¼´å’Œä¾èµ–ï¼Œç‹¬å¤„æ—¶å®¹æ˜“ç„¦è™‘ã€‚ä½ çš„å®‰å…¨æ„Ÿå¾ˆå¤§ç¨‹åº¦æ¥æºäºä¼´ä¾£ã€‚', 'ä½ æ—¢äº«å—é™ªä¼´ï¼Œä¹Ÿèƒ½å®‰äºç‹¬å¤„ã€‚ä½ åœ¨å…³ç³»ä¸­ä¿æŒç€å¥åº·çš„è·ç¦»æ„Ÿã€‚', 'ä½ æ˜¯ä¸€åŒ¹ç‹¬ç‹¼ï¼Œæåº¦éœ€è¦ä¸ªäººç©ºé—´ã€‚å¦‚æœä¼´ä¾£å¤ªç²˜äººï¼Œä½ ä¼šæ„Ÿåˆ°çª’æ¯ã€‚'],
        ['ä½ å–œæ¬¢æ–°é²œæ„Ÿå’Œå˜åŒ–ï¼Œè®¨åŒä¸€æˆä¸å˜ã€‚ä½ éœ€è¦ä¸€ä¸ªèƒ½é™ªä½ ä¸€èµ·ç–¯çš„ä¼´ä¾£ã€‚', 'ä½ åœ¨ç¨³å®šä¸æ¢ç´¢ä¹‹é—´æ‰¾åˆ°äº†å¹³è¡¡ã€‚æ—¢èƒ½äº«å—å®‰ç¨³æ—¥å­ï¼Œä¹Ÿä¸æ’æ–¥å¶å°”çš„å†’é™©ã€‚', 'ä½ æåº¦è¿½æ±‚ç¨³å®šå’Œå¯é¢„æµ‹æ€§ã€‚ä»»ä½•çªå‘çŠ¶å†µéƒ½ä¼šè®©ä½ æ„Ÿåˆ°ä¸å®‰ã€‚'],
        ['ä½ æ˜¯æ— å¯æ•‘è¯çš„æµªæ¼«ä¸»ä¹‰è€…ï¼Œæ„Ÿè§‰å¯¹ä½ æ¥è¯´æ¯”é¢åŒ…é‡è¦å¾—å¤šã€‚', 'ä½ æ—¢çœ‹é‡æ„Ÿè§‰ï¼Œä¹Ÿè€ƒè™‘ç°å®ã€‚ä½ ä¸ä¼šä¸ºäº†çˆ±æƒ…é¥¿è‚šå­ï¼Œä¹Ÿä¸ä¼šä¸ºäº†é¢åŒ…å°†å°±ã€‚', 'ä½ æ˜¯å½»åº•çš„åŠ¡å®æ´¾ã€‚ä½ è®¤ä¸ºæ²¡æœ‰ç‰©è´¨åŸºç¡€çš„çˆ±æƒ…æ˜¯ä¸€ç›˜æ•£æ²™ã€‚']
    ];
    
    let dimHtml = '';
    res.s.forEach((score, i) => {
        let level = score < 40 ? 0 : (score < 70 ? 1 : 2);
        let levelText = ['åä½', 'é€‚ä¸­', 'åé«˜'][level];
        dimHtml += `
            <div class="dim-detail-box">
                <div class="dim-header"><span>${dims[i]} (${score}åˆ†)</span><span>${levelText}</span></div>
                <div class="dim-bar-bg"><div class="dim-bar-val" style="width:${score}%"></div></div>
                <div class="dim-desc">${dimDescs[i][level]}</div>
            </div>
        `;
    });
    document.getElementById('dimensionAnalysisContent').innerHTML = dimHtml;

    // 2. æ½œæ„è¯†
    let subHtml = `<p><strong>å†…åœ¨å°å­©éœ€æ±‚ï¼š</strong>ä½ å†…å¿ƒæ·±å¤„æ¸´æœ›ä¸€ä¸ªèƒ½å¤Ÿ${res.s[1]>60 ? 'å°Šé‡ä½ ç‹¬ç«‹ç©ºé—´' : 'æ— æ—¶æ— åˆ»å…³æ³¨ä½ '}çš„å¯¹è±¡ã€‚${res.s[0]>60 ? 'ä½ é€šè¿‡æŒæ§æ¥è·å¾—å®‰å…¨æ„Ÿï¼Œå®³æ€•å¤±æ§ã€‚' : 'ä½ é€šè¿‡é¡ºä»æ¥è·å¾—å®‰å…¨æ„Ÿï¼Œå®³æ€•å†²çªã€‚'}</p>`;
    document.getElementById('subconsciousContent').innerHTML = subHtml;

    // 3. å…³ç³»ç›²ç‚¹
    document.getElementById('fullAnalysis').innerHTML = `<p>âœ… <strong>æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong>${t.adv}</p><p>ğŸš§ <strong>ç›²ç‚¹ä¸é£é™©ï¼š</strong>${t.risk}</p>`;
    
    // 4. 30å¤©è®¡åˆ’
    let plans = [
        'ç¬¬1å‘¨ [è§‰å¯Ÿ]ï¼šè®°å½•ä¸‹ä½ æ„Ÿåˆ°"ç„¦è™‘"æˆ–"æ„¤æ€’"çš„æ—¶åˆ»ï¼Œåˆ†ææ˜¯å› ä¸ºéœ€æ±‚æœªè¢«æ»¡è¶³ï¼Œè¿˜æ˜¯è¾¹ç•Œè¢«ä¾µçŠ¯ã€‚',
        'ç¬¬2å‘¨ [æ²Ÿé€š]ï¼šä½¿ç”¨"æˆ‘è¯­å¢ƒ"ï¼ˆI-statementï¼‰è¡¨è¾¾éœ€æ±‚ã€‚ä¾‹å¦‚ï¼š"æˆ‘æ„Ÿåˆ°...å› ä¸º..."ï¼Œè€Œä¸æ˜¯"ä½ æ€»æ˜¯..."ã€‚',
        'ç¬¬3å‘¨ [å¹³è¡¡]ï¼šå¦‚æœåˆ†æ•°ä¸ºé«˜ä¸»å¯¼ï¼Œå°è¯•æ”¾æƒï¼›å¦‚æœåˆ†æ•°ä¸ºé«˜ä¾èµ–ï¼Œå°è¯•ç‹¬ç«‹å®Œæˆä¸€ä»¶å°äº‹ã€‚',
        'ç¬¬4å‘¨ [å¤ç›˜]ï¼šå›é¡¾å…³ç³»å˜åŒ–ï¼Œæ‰¾åˆ°æœ€èˆ’é€‚çš„ç›¸å¤„è·ç¦»ã€‚'
    ];
    document.getElementById('actionPlan').innerHTML = plans.map(x=>`<li>${x}</li>`).join('');
    
    // 5. æ²Ÿé€šè¯æœ¯
    let commHtml = `
        <div class="advice-card-item">
            <div class="advice-title">ğŸ”¥ å½“å‘ç”Ÿå†²çªæ—¶</div>
            <div class="advice-content">â€œæˆ‘ç°åœ¨æƒ…ç»ªæœ‰ç‚¹æ¿€åŠ¨ï¼Œä¸ºäº†ä¸è¯¯ä¼¤ä½ ï¼Œæˆ‘ä»¬éœ€è¦æš‚åœ15åˆ†é’Ÿã€‚ä½†æˆ‘ä¿è¯15åˆ†é’Ÿåå›æ¥è§£å†³é—®é¢˜ã€‚â€</div>
        </div>
        <div class="advice-card-item">
            <div class="advice-title">â¤ï¸ å½“éœ€è¦å®‰æ…°æ—¶</div>
            <div class="advice-content">â€œæˆ‘ç°åœ¨ä¸éœ€è¦å»ºè®®ï¼Œæˆ‘åªéœ€è¦ä¸€ä¸ªæ‹¥æŠ±ï¼Œå¯ä»¥å—ï¼Ÿâ€</div>
        </div>
    `;
    document.getElementById('communicationTips').innerHTML = commHtml;

    // 6. é¿å‘
    document.getElementById('warningText').innerText = "âš ï¸ è­¦æƒ•ï¼šä½ çš„äº’è¡¥å‹ä¼´ä¾£ï¼ˆ" + (res.k.includes('M')?'D':'M') + "å¼€å¤´ç±»å‹ï¼‰è™½ç„¶å¯¹ä½ æœ‰è‡´å‘½å¸å¼•åŠ›ï¼Œä½†ä¹Ÿæœ€å®¹æ˜“è§¦å‘ä½ çš„é˜²å¾¡æœºåˆ¶ã€‚å·®å¼‚æ˜¯ç”¨æ¥äº’è¡¥çš„ï¼Œè€Œä¸æ˜¯ç”¨æ¥å¯¹æŠ—çš„ã€‚";

    // ç»˜åˆ¶å›¾è¡¨
    let chartConfig = {
        type: 'radar',
        data: {
            labels: dims,
            datasets: [{
                data: res.s,
                backgroundColor: 'rgba(160,127,86,0.2)',
                borderColor: '#A07F56',
                pointBackgroundColor: '#A07F56',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: '#A07F56'
            }]
        },
        options: {
            maintainAspectRatio: false,
            scale: {
                ticks: { display: true, beginAtZero: true, max: 100, stepSize: 20, fontSize: 10, fontColor: '#999' },
                pointLabels: { fontSize: 12, fontColor: '#333' },
                gridLines: { color: '#eee' }
            },
            legend: { display: false },
            layout: { padding: 10 }
        }
    };
    
    setTimeout(()=>{
        new Chart(document.getElementById('fullRadarChart'), chartConfig);
    }, 200);
    window.scrollTo(0,0);
}

function copyTxt(t) {
    const ta = document.createElement('textarea');
    ta.value = t; document.body.appendChild(ta); ta.select();
    try{document.execCommand('copy');alert('å¤åˆ¶æˆåŠŸ');}catch(e){alert('è¯·é•¿æŒ‰å¤åˆ¶');}
    document.body.removeChild(ta);
}
function copyWx() { copyTxt('HCH91178'); setTimeout(()=>{location.href='weixin://'},500); }

function showAdmin() { document.getElementById('homePage').classList.add('hidden'); document.getElementById('adminPage').classList.remove('hidden'); }
function login() {
    if(document.getElementById('admPwd').value===CONFIG.ADMIN_PWD) {
        document.getElementById('adminLogin').classList.add('hidden');
        document.getElementById('adminMain').classList.remove('hidden');
        renderAdmin();
    } else alert('å¯†ç é”™è¯¯');
}
function genCards() {
    let n = +document.getElementById('genCount').value;
    let cards = JSON.parse(localStorage.getItem('ageCards')||'[]');
    batchCards = [];
    for(let i=0; i<n; i++) {
        let c = 'NS-'+Math.random().toString(36).substr(2,4).toUpperCase()+'-'+Math.random().toString(36).substr(2,4).toUpperCase();
        let item = {code:c, used:false};
        cards.push(item); batchCards.push(item);
    }
    localStorage.setItem('ageCards', JSON.stringify(cards));
    alert('ç”ŸæˆæˆåŠŸ'); renderAdmin();
}
function renderAdmin() {
    let cards = JSON.parse(localStorage.getItem('ageCards')||'[]');
    document.getElementById('validCount').innerText = cards.filter(x=>!x.used).length;
    document.getElementById('cardList').innerHTML = cards.slice(0,50).map(x=>
        `<div style="display:flex;justify-content:space-between;border-bottom:1px solid #eee;padding:5px;"><span>${x.code}</span><span style="color:${x.used?'red':'green'}">${x.used?'å·²ç”¨':'æœªç”¨'}</span></div>`
    ).join('');
}
function exportNew() { download(batchCards.map(x=>x.code).join('\n'), 'new_ns_cards.txt'); }
function exportAll() { 
    let cards = JSON.parse(localStorage.getItem('ageCards')||'[]');
    download(cards.map(x=>x.code).join('\n'), 'all_ns_cards.txt'); 
}
function download(txt, name) {
    let a = document.createElement('a');
    a.href = URL.createObjectURL(new Blob([txt],{type:'text/plain'}));
    a.download = name; a.click();
}
</script>
</body>
</html>
